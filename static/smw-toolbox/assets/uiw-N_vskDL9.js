import{E as k,H as Oo,s as ln,F as Le,c as Ke,S as De,T as Rt,C as Li,a as Di,b as _,d as O,I as Ro,g as Io,e as an,i as at,f as Po,h as $o,j as Vt,A as xt,m as be,k as Ee,N as zt,D as No,l as pe,n as We,V as kt,o as E,P as cn,p as V,q as un,r as oe,t as fn,u as P,v as Fe,R as Ei,w as Ti,x as hn,y as Bi,z as Wo,B as ct,M as Oi,G as Ri,J as Ii,K as Pi,W as $i,L as Ni,O as Wi,Q as Fi,U as Ui,X as Hi,Y as Vi,Z as zi,_ as qi,$ as ji,a0 as Ki,a1 as Gi,a2 as Ji,a3 as Qi,a4 as g,a5 as Yi}from"./codemirror-CrYJ7M0P.js";var Ge,y,Fo,fe,Wn,Uo,qt,dn,jt,Kt,Ho,Ue={},Vo=[],Zi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ct=Array.isArray;function re(t,e){for(var n in e)t[n]=e[n];return t}function zo(t){var e=t.parentNode;e&&e.removeChild(t)}function X(t,e,n){var o,r,i,s={};for(i in e)i=="key"?o=e[i]:i=="ref"?r=e[i]:s[i]=e[i];if(arguments.length>2&&(s.children=arguments.length>3?Ge.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)s[i]===void 0&&(s[i]=t.defaultProps[i]);return $e(t,s,o,r,null)}function $e(t,e,n,o,r){var i={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++Fo,__i:-1,__u:0};return r==null&&y.vnode!=null&&y.vnode(i),i}function qo(){return{current:null}}function ee(t){return t.children}function G(t,e){this.props=t,this.context=e}function me(t,e){if(e==null)return t.__?me(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?me(t):null}function jo(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return jo(t)}}function Gt(t){(!t.__d&&(t.__d=!0)&&fe.push(t)&&!ut.__r++||Wn!==y.debounceRendering)&&((Wn=y.debounceRendering)||Uo)(ut)}function ut(){var t,e,n,o,r,i,s,l;for(fe.sort(qt);t=fe.shift();)t.__d&&(e=fe.length,o=void 0,i=(r=(n=t).__v).__e,s=[],l=[],n.__P&&((o=re({},r)).__v=r.__v+1,y.vnode&&y.vnode(o),pn(n.__P,o,r,n.__n,n.__P.namespaceURI,32&r.__u?[i]:null,s,i??me(r),!!(32&r.__u),l),o.__v=r.__v,o.__.__k[o.__i]=o,Jo(s,o,l),o.__e!=i&&jo(o)),fe.length>e&&fe.sort(qt));ut.__r=0}function Ko(t,e,n,o,r,i,s,l,a,c,f){var u,d,h,p,b,x=o&&o.__k||Vo,v=e.length;for(n.__d=a,Xi(n,e,x),a=n.__d,u=0;u<v;u++)(h=n.__k[u])!=null&&typeof h!="boolean"&&typeof h!="function"&&(d=h.__i===-1?Ue:x[h.__i]||Ue,h.__i=u,pn(t,h,d,r,i,s,l,a,c,f),p=h.__e,h.ref&&d.ref!=h.ref&&(d.ref&&mn(d.ref,null,h),f.push(h.ref,h.__c||p,h)),b==null&&p!=null&&(b=p),65536&h.__u||d.__k===h.__k?a=Go(h,a,t):typeof h.type=="function"&&h.__d!==void 0?a=h.__d:p&&(a=p.nextSibling),h.__d=void 0,h.__u&=-196609);n.__d=a,n.__e=b}function Xi(t,e,n){var o,r,i,s,l,a=e.length,c=n.length,f=c,u=0;for(t.__k=[],o=0;o<a;o++)s=o+u,(r=t.__k[o]=(r=e[o])==null||typeof r=="boolean"||typeof r=="function"?null:typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?$e(null,r,null,null,null):Ct(r)?$e(ee,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?$e(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)!=null?(r.__=t,r.__b=t.__b+1,l=es(r,n,s,f),r.__i=l,i=null,l!==-1&&(f--,(i=n[l])&&(i.__u|=131072)),i==null||i.__v===null?(l==-1&&u--,typeof r.type!="function"&&(r.__u|=65536)):l!==s&&(l==s-1?u--:l==s+1?u++:l>s?f>a-s?u+=l-s:u--:l<s&&(l==s-u?u-=l-s:u++),l!==o+u&&(r.__u|=65536))):(i=n[s])&&i.key==null&&i.__e&&!(131072&i.__u)&&(i.__e==t.__d&&(t.__d=me(i)),Jt(i,i,!1),n[s]=null,f--);if(f)for(o=0;o<c;o++)(i=n[o])!=null&&!(131072&i.__u)&&(i.__e==t.__d&&(t.__d=me(i)),Jt(i,i))}function Go(t,e,n){var o,r;if(typeof t.type=="function"){for(o=t.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=t,e=Go(o[r],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=me(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function ie(t,e){return e=e||[],t==null||typeof t=="boolean"||(Ct(t)?t.some(function(n){ie(n,e)}):e.push(t)),e}function es(t,e,n,o){var r=t.key,i=t.type,s=n-1,l=n+1,a=e[n];if(a===null||a&&r==a.key&&i===a.type&&!(131072&a.__u))return n;if(o>(a!=null&&!(131072&a.__u)?1:0))for(;s>=0||l<e.length;){if(s>=0){if((a=e[s])&&!(131072&a.__u)&&r==a.key&&i===a.type)return s;s--}if(l<e.length){if((a=e[l])&&!(131072&a.__u)&&r==a.key&&i===a.type)return l;l++}}return-1}function Fn(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Zi.test(e)?n:n+"px"}function et(t,e,n,o,r){var i;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||Fn(t.style,e,"");if(n)for(e in n)o&&n[e]===o[e]||Fn(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?o?n.u=o.u:(n.u=dn,t.addEventListener(e,i?Kt:jt,i)):t.removeEventListener(e,i?Kt:jt,i);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Un(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=dn++;else if(e.t<n.u)return;return n(y.event?y.event(e):e)}}}function pn(t,e,n,o,r,i,s,l,a,c){var f,u,d,h,p,b,x,v,m,T,A,w,R,W,ne,L,D=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(a=!!(32&n.__u),i=[l=e.__e=n.__e]),(f=y.__b)&&f(e);e:if(typeof D=="function")try{if(v=e.props,m="prototype"in D&&D.prototype.render,T=(f=D.contextType)&&o[f.__c],A=f?T?T.props.value:f.__:o,n.__c?x=(u=e.__c=n.__c).__=u.__E:(m?e.__c=u=new D(v,A):(e.__c=u=new G(v,A),u.constructor=D,u.render=ns),T&&T.sub(u),u.props=v,u.state||(u.state={}),u.context=A,u.__n=o,d=u.__d=!0,u.__h=[],u._sb=[]),m&&u.__s==null&&(u.__s=u.state),m&&D.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=re({},u.__s)),re(u.__s,D.getDerivedStateFromProps(v,u.__s))),h=u.props,p=u.state,u.__v=e,d)m&&D.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),m&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(m&&D.getDerivedStateFromProps==null&&v!==h&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(v,A),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(v,u.__s,A)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(u.props=v,u.state=u.__s,u.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(j){j&&(j.__=e)}),w=0;w<u._sb.length;w++)u.__h.push(u._sb[w]);u._sb=[],u.__h.length&&s.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(v,u.__s,A),m&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(h,p,b)})}if(u.context=A,u.props=v,u.__P=t,u.__e=!1,R=y.__r,W=0,m){for(u.state=u.__s,u.__d=!1,R&&R(e),f=u.render(u.props,u.state,u.context),ne=0;ne<u._sb.length;ne++)u.__h.push(u._sb[ne]);u._sb=[]}else do u.__d=!1,R&&R(e),f=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++W<25);u.state=u.__s,u.getChildContext!=null&&(o=re(re({},o),u.getChildContext())),m&&!d&&u.getSnapshotBeforeUpdate!=null&&(b=u.getSnapshotBeforeUpdate(h,p)),Ko(t,Ct(L=f!=null&&f.type===ee&&f.key==null?f.props.children:f)?L:[L],e,n,o,r,i,s,l,a,c),u.base=e.__e,e.__u&=-161,u.__h.length&&s.push(u),x&&(u.__E=u.__=null)}catch(j){if(e.__v=null,a||i!=null){for(e.__u|=a?160:32;l&&l.nodeType===8&&l.nextSibling;)l=l.nextSibling;i[i.indexOf(l)]=null,e.__e=l}else e.__e=n.__e,e.__k=n.__k;y.__e(j,e,n)}else i==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=ts(n.__e,e,n,o,r,i,s,a,c);(f=y.diffed)&&f(e)}function Jo(t,e,n){e.__d=void 0;for(var o=0;o<n.length;o++)mn(n[o],n[++o],n[++o]);y.__c&&y.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(i){i.call(r)})}catch(i){y.__e(i,r.__v)}})}function ts(t,e,n,o,r,i,s,l,a){var c,f,u,d,h,p,b,x=n.props,v=e.props,m=e.type;if(m==="svg"?r="http://www.w3.org/2000/svg":m==="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),i!=null){for(c=0;c<i.length;c++)if((h=i[c])&&"setAttribute"in h==!!m&&(m?h.localName===m:h.nodeType===3)){t=h,i[c]=null;break}}if(t==null){if(m===null)return document.createTextNode(v);t=document.createElementNS(r,m,v.is&&v),i=null,l=!1}if(m===null)x===v||l&&t.data===v||(t.data=v);else{if(i=i&&Ge.call(t.childNodes),x=n.props||Ue,!l&&i!=null)for(x={},c=0;c<t.attributes.length;c++)x[(h=t.attributes[c]).name]=h.value;for(c in x)if(h=x[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=h;else if(c!=="key"&&!(c in v)){if(c=="value"&&"defaultValue"in v||c=="checked"&&"defaultChecked"in v)continue;et(t,c,null,h,r)}}for(c in v)h=v[c],c=="children"?d=h:c=="dangerouslySetInnerHTML"?f=h:c=="value"?p=h:c=="checked"?b=h:c==="key"||l&&typeof h!="function"||x[c]===h||et(t,c,h,x[c],r);if(f)l||u&&(f.__html===u.__html||f.__html===t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(u&&(t.innerHTML=""),Ko(t,Ct(d)?d:[d],e,n,o,m==="foreignObject"?"http://www.w3.org/1999/xhtml":r,i,s,i?i[0]:n.__k&&me(n,0),l,a),i!=null)for(c=i.length;c--;)i[c]!=null&&zo(i[c]);l||(c="value",p!==void 0&&(p!==t[c]||m==="progress"&&!p||m==="option"&&p!==x[c])&&et(t,c,p,x[c],r),c="checked",b!==void 0&&b!==t[c]&&et(t,c,b,x[c],r))}return t}function mn(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(r){y.__e(r,n)}}function Jt(t,e,n){var o,r;if(y.unmount&&y.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||mn(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){y.__e(i,e)}o.base=o.__P=null}if(o=t.__k)for(r=0;r<o.length;r++)o[r]&&Jt(o[r],e,n||typeof t.type!="function");n||t.__e==null||zo(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function ns(t,e,n){return this.constructor(t,n)}function He(t,e,n){var o,r,i,s;y.__&&y.__(t,e),r=(o=typeof n=="function")?null:n&&n.__k||e.__k,i=[],s=[],pn(e,t=(!o&&n||e).__k=X(ee,null,[t]),r||Ue,Ue,e.namespaceURI,!o&&n?[n]:r?null:e.firstChild?Ge.call(e.childNodes):null,i,!o&&n?n:r?r.__e:e.firstChild,o,s),Jo(i,t,s)}function Qo(t,e){He(t,e,Qo)}function os(t,e,n){var o,r,i,s,l=re({},t.props);for(i in t.type&&t.type.defaultProps&&(s=t.type.defaultProps),e)i=="key"?o=e[i]:i=="ref"?r=e[i]:l[i]=e[i]===void 0&&s!==void 0?s[i]:e[i];return arguments.length>2&&(l.children=arguments.length>3?Ge.call(arguments,2):n),$e(t.type,l,o||t.key,r||t.ref,null)}function Yo(t,e){var n={__c:e="__cC"+Ho++,__:t,Consumer:function(o,r){return o.children(r)},Provider:function(o){var r,i;return this.getChildContext||(r=[],(i={})[e]=this,this.getChildContext=function(){return i},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(s){this.props.value!==s.value&&r.some(function(l){l.__e=!0,Gt(l)})},this.sub=function(s){r.push(s);var l=s.componentWillUnmount;s.componentWillUnmount=function(){r&&r.splice(r.indexOf(s),1),l&&l.call(s)}}),o.children}};return n.Provider.__=n.Consumer.contextType=n}Ge=Vo.slice,y={__e:function(t,e,n,o){for(var r,i,s;e=e.__;)if((r=e.__c)&&!r.__)try{if((i=r.constructor)&&i.getDerivedStateFromError!=null&&(r.setState(i.getDerivedStateFromError(t)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,o||{}),s=r.__d),s)return r.__E=r}catch(l){t=l}throw t}},Fo=0,G.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=re({},this.state),typeof t=="function"&&(t=t(re({},n),this.props)),t&&re(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Gt(this))},G.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Gt(this))},G.prototype.render=ee,fe=[],Uo=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,qt=function(t,e){return t.__v.__b-e.__v.__b},ut.__r=0,dn=0,jt=Un(!1),Kt=Un(!0),Ho=0;var rs=0;function is(t,e,n,o,r,i){e||(e={});var s,l,a=e;if("ref"in a)for(l in a={},e)l=="ref"?s=e[l]:a[l]=e[l];var c={type:t,props:a,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--rs,__i:-1,__u:0,__source:r,__self:i};if(typeof t=="function"&&(s=t.defaultProps))for(l in s)a[l]===void 0&&(a[l]=s[l]);return y.vnode&&y.vnode(c),c}var se,C,It,Hn,Ae=0,Zo=[],M=y,Vn=M.__b,zn=M.__r,qn=M.diffed,jn=M.__c,Kn=M.unmount,Gn=M.__;function ge(t,e){M.__h&&M.__h(C,t,Ae||e),Ae=0;var n=C.__H||(C.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function le(t){return Ae=1,St(Xo,t)}function St(t,e,n){var o=ge(se++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):Xo(void 0,e),function(l){var a=o.__N?o.__N[0]:o.__[0],c=o.t(a,l);a!==c&&(o.__N=[c,o.__[1]],o.__c.setState({}))}],o.__c=C,!C.u)){var r=function(l,a,c){if(!o.__c.__H)return!0;var f=o.__c.__H.__.filter(function(d){return!!d.__c});if(f.every(function(d){return!d.__N}))return!i||i.call(this,l,a,c);var u=!1;return f.forEach(function(d){if(d.__N){var h=d.__[0];d.__=d.__N,d.__N=void 0,h!==d.__[0]&&(u=!0)}}),!(!u&&o.__c.props===l)&&(!i||i.call(this,l,a,c))};C.u=!0;var i=C.shouldComponentUpdate,s=C.componentWillUpdate;C.componentWillUpdate=function(l,a,c){if(this.__e){var f=i;i=void 0,r(l,a,c),i=f}s&&s.call(this,l,a,c)},C.shouldComponentUpdate=r}return o.__N||o.__}function Q(t,e){var n=ge(se++,3);!M.__s&&bn(n.__H,e)&&(n.__=t,n.i=e,C.__H.__h.push(n))}function Te(t,e){var n=ge(se++,4);!M.__s&&bn(n.__H,e)&&(n.__=t,n.i=e,C.__h.push(n))}function At(t){return Ae=5,Je(function(){return{current:t}},[])}function wt(t,e,n){Ae=6,Te(function(){return typeof t=="function"?(t(e()),function(){return t(null)}):t?(t.current=e(),function(){return t.current=null}):void 0},n==null?n:n.concat(t))}function Je(t,e){var n=ge(se++,7);return bn(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function gn(t,e){return Ae=8,Je(function(){return t},e)}function _n(t){var e=C.context[t.__c],n=ge(se++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(C)),e.props.value):t.__}function yn(t,e){M.useDebugValue&&M.useDebugValue(e?e(t):t)}function ss(t){var e=ge(se++,10),n=le();return e.__=t,C.componentDidCatch||(C.componentDidCatch=function(o,r){e.__&&e.__(o,r),n[1](o)}),[n[0],function(){n[1](void 0)}]}function vn(){var t=ge(se++,11);if(!t.__){for(var e=C.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function ls(){for(var t;t=Zo.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(st),t.__H.__h.forEach(Qt),t.__H.__h=[]}catch(e){t.__H.__h=[],M.__e(e,t.__v)}}M.__b=function(t){C=null,Vn&&Vn(t)},M.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Gn&&Gn(t,e)},M.__r=function(t){zn&&zn(t),se=0;var e=(C=t.__c).__H;e&&(It===C?(e.__h=[],C.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(st),e.__h.forEach(Qt),e.__h=[],se=0)),It=C},M.diffed=function(t){qn&&qn(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Zo.push(e)!==1&&Hn===M.requestAnimationFrame||((Hn=M.requestAnimationFrame)||as)(ls)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),It=C=null},M.__c=function(t,e){e.some(function(n){try{n.__h.forEach(st),n.__h=n.__h.filter(function(o){return!o.__||Qt(o)})}catch(o){e.some(function(r){r.__h&&(r.__h=[])}),e=[],M.__e(o,n.__v)}}),jn&&jn(t,e)},M.unmount=function(t){Kn&&Kn(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{st(o)}catch(r){e=r}}),n.__H=void 0,e&&M.__e(e,n.__v))};var Jn=typeof requestAnimationFrame=="function";function as(t){var e,n=function(){clearTimeout(o),Jn&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,100);Jn&&(e=requestAnimationFrame(n))}function st(t){var e=C,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),C=e}function Qt(t){var e=C;t.__c=t.__(),C=e}function bn(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Xo(t,e){return typeof e=="function"?e(t):e}function er(t,e){for(var n in e)t[n]=e[n];return t}function Yt(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var o in e)if(o!=="__source"&&t[o]!==e[o])return!0;return!1}function ft(t,e){this.props=t,this.context=e}function tr(t,e){function n(r){var i=this.props.ref,s=i==r.ref;return!s&&i&&(i.call?i(null):i.current=null),e?!e(this.props,r)||!s:Yt(this.props,r)}function o(r){return this.shouldComponentUpdate=n,X(t,r)}return o.displayName="Memo("+(t.displayName||t.name)+")",o.prototype.isReactComponent=!0,o.__f=!0,o}(ft.prototype=new G).isPureReactComponent=!0,ft.prototype.shouldComponentUpdate=function(t,e){return Yt(this.props,t)||Yt(this.state,e)};var Qn=y.__b;y.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Qn&&Qn(t)};var cs=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function xn(t){function e(n){var o=er({},n);return delete o.ref,t(o,n.ref||null)}return e.$$typeof=cs,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var Yn=function(t,e){return t==null?null:ie(ie(t).map(e))},nr={map:Yn,forEach:Yn,count:function(t){return t?ie(t).length:0},only:function(t){var e=ie(t);if(e.length!==1)throw"Children.only";return e[0]},toArray:ie},us=y.__e;y.__e=function(t,e,n,o){if(t.then){for(var r,i=e;i=i.__;)if((r=i.__c)&&r.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e)}us(t,e,n,o)};var Zn=y.unmount;function or(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(o){typeof o.__c=="function"&&o.__c()}),t.__c.__H=null),(t=er({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(o){return or(o,e,n)})),t}function rr(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(o){return rr(o,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Ne(){this.__u=0,this.t=null,this.__b=null}function ir(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function sr(t){var e,n,o;function r(i){if(e||(e=t()).then(function(s){n=s.default||s},function(s){o=s}),o)throw o;if(!n)throw e;return X(n,i)}return r.displayName="Lazy",r.__f=!0,r}function xe(){this.u=null,this.o=null}y.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Zn&&Zn(t)},(Ne.prototype=new G).__c=function(t,e){var n=e.__c,o=this;o.t==null&&(o.t=[]),o.t.push(n);var r=ir(o.__v),i=!1,s=function(){i||(i=!0,n.__R=null,r?r(l):l())};n.__R=s;var l=function(){if(!--o.__u){if(o.state.__a){var a=o.state.__a;o.__v.__k[0]=rr(a,a.__c.__P,a.__c.__O)}var c;for(o.setState({__a:o.__b=null});c=o.t.pop();)c.forceUpdate()}};o.__u++||32&e.__u||o.setState({__a:o.__b=o.__v.__k[0]}),t.then(s,s)},Ne.prototype.componentWillUnmount=function(){this.t=[]},Ne.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=or(this.__b,n,o.__O=o.__P)}this.__b=null}var r=e.__a&&X(ee,null,t.fallback);return r&&(r.__u&=-33),[X(ee,null,e.__a?null:t.children),r]};var Xn=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function fs(t){return this.getChildContext=function(){return t.context},t.children}function hs(t){var e=this,n=t.i;e.componentWillUnmount=function(){He(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],contains:function(){return!0},appendChild:function(o){this.childNodes.push(o),e.i.appendChild(o)},insertBefore:function(o,r){this.childNodes.push(o),e.i.appendChild(o)},removeChild:function(o){this.childNodes.splice(this.childNodes.indexOf(o)>>>1,1),e.i.removeChild(o)}}),He(X(fs,{context:e.context},t.__v),e.l)}function lr(t,e){var n=X(hs,{__v:t,i:e});return n.containerInfo=e,n}(xe.prototype=new G).__a=function(t){var e=this,n=ir(e.__v),o=e.o.get(t);return o[0]++,function(r){var i=function(){e.props.revealOrder?(o.push(r),Xn(e,t,o)):r()};n?n(i):i()}},xe.prototype.render=function(t){this.u=null,this.o=new Map;var e=ie(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},xe.prototype.componentDidUpdate=xe.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){Xn(t,n,e)})};var ar=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ds=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ps=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ms=/[A-Z0-9]/g,gs=typeof document<"u",_s=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function cr(t,e,n){return e.__k==null&&(e.textContent=""),He(t,e),typeof n=="function"&&n(),t?t.__c:null}function ur(t,e,n){return Qo(t,e),typeof n=="function"&&n(),t?t.__c:null}G.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(G.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var eo=y.event;function ys(){}function vs(){return this.cancelBubble}function bs(){return this.defaultPrevented}y.event=function(t){return eo&&(t=eo(t)),t.persist=ys,t.isPropagationStopped=vs,t.isDefaultPrevented=bs,t.nativeEvent=t};var kn,xs={enumerable:!1,configurable:!0,get:function(){return this.class}},to=y.vnode;y.vnode=function(t){typeof t.type=="string"&&function(e){var n=e.props,o=e.type,r={},i=o.indexOf("-")===-1;for(var s in n){var l=n[s];if(!(s==="value"&&"defaultValue"in n&&l==null||gs&&s==="children"&&o==="noscript"||s==="class"||s==="className")){var a=s.toLowerCase();s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&l===!0?l="":a==="translate"&&l==="no"?l=!1:a[0]==="o"&&a[1]==="n"?a==="ondoubleclick"?s="ondblclick":a!=="onchange"||o!=="input"&&o!=="textarea"||_s(n.type)?a==="onfocus"?s="onfocusin":a==="onblur"?s="onfocusout":ps.test(s)&&(s=a):a=s="oninput":i&&ds.test(s)?s=s.replace(ms,"-$&").toLowerCase():l===null&&(l=void 0),a==="oninput"&&r[s=a]&&(s="oninputCapture"),r[s]=l}}o=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=ie(n.children).forEach(function(c){c.props.selected=r.value.indexOf(c.props.value)!=-1})),o=="select"&&r.defaultValue!=null&&(r.value=ie(n.children).forEach(function(c){c.props.selected=r.multiple?r.defaultValue.indexOf(c.props.value)!=-1:r.defaultValue==c.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",xs)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),e.props=r}(t),t.$$typeof=ar,to&&to(t)};var no=y.__r;y.__r=function(t){no&&no(t),kn=t.__c};var oo=y.diffed;y.diffed=function(t){oo&&oo(t);var e=t.props,n=t.__e;n!=null&&t.type==="textarea"&&"value"in e&&e.value!==n.value&&(n.value=e.value==null?"":e.value),kn=null};var fr={ReactCurrentDispatcher:{current:{readContext:function(t){return kn.__n[t.__c].props.value},useCallback:gn,useContext:_n,useDebugValue:yn,useDeferredValue:Sn,useEffect:Q,useId:vn,useImperativeHandle:wt,useInsertionEffect:wn,useLayoutEffect:Te,useMemo:Je,useReducer:St,useRef:At,useState:le,useSyncExternalStore:Mn,useTransition:An}}},ks="17.0.2";function hr(t){return X.bind(null,t)}function Qe(t){return!!t&&t.$$typeof===ar}function dr(t){return Qe(t)&&t.type===ee}function pr(t){return!!t&&!!t.displayName&&(typeof t.displayName=="string"||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function mr(t){return Qe(t)?os.apply(null,arguments):t}function gr(t){return!!t.__k&&(He(null,t),!0)}function _r(t){return t&&(t.base||t.nodeType===1&&t)||null}var yr=function(t,e){return t(e)},vr=function(t,e){return t(e)},br=ee;function Cn(t){t()}function Sn(t){return t}function An(){return[!1,Cn]}var wn=Te,xr=Qe;function Mn(t,e){var n=e(),o=le({h:{__:n,v:e}}),r=o[0].h,i=o[1];return Te(function(){r.__=n,r.v=e,Pt(r)&&i({h:r})},[t,n,e]),Q(function(){return Pt(r)&&i({h:r}),t(function(){Pt(r)&&i({h:r})})},[t]),n}function Pt(t){var e,n,o=t.v,r=t.__;try{var i=o();return!((e=r)===(n=i)&&(e!==0||1/e==1/n)||e!=e&&n!=n)}catch{return!0}}var Cs={useState:le,useId:vn,useReducer:St,useEffect:Q,useLayoutEffect:Te,useInsertionEffect:wn,useTransition:An,useDeferredValue:Sn,useSyncExternalStore:Mn,startTransition:Cn,useRef:At,useImperativeHandle:wt,useMemo:Je,useCallback:gn,useContext:_n,useDebugValue:yn,version:"17.0.2",Children:nr,render:cr,hydrate:ur,unmountComponentAtNode:gr,createPortal:lr,createElement:X,createContext:Yo,createFactory:hr,cloneElement:mr,createRef:qo,Fragment:ee,isValidElement:Qe,isElement:xr,isFragment:dr,isMemo:pr,findDOMNode:_r,Component:G,PureComponent:ft,memo:tr,forwardRef:xn,flushSync:vr,unstable_batchedUpdates:yr,StrictMode:br,Suspense:Ne,SuspenseList:xe,lazy:sr,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:fr};const Ec=Object.freeze(Object.defineProperty({__proto__:null,Children:nr,Component:G,Fragment:ee,PureComponent:ft,StrictMode:br,Suspense:Ne,SuspenseList:xe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:fr,cloneElement:mr,createContext:Yo,createElement:X,createFactory:hr,createPortal:lr,createRef:qo,default:Cs,findDOMNode:_r,flushSync:vr,forwardRef:xn,hydrate:ur,isElement:xr,isFragment:dr,isMemo:pr,isValidElement:Qe,lazy:sr,memo:tr,render:cr,startTransition:Cn,unmountComponentAtNode:gr,unstable_batchedUpdates:yr,useCallback:gn,useContext:_n,useDebugValue:yn,useDeferredValue:Sn,useEffect:Q,useErrorBoundary:ss,useId:vn,useImperativeHandle:wt,useInsertionEffect:wn,useLayoutEffect:Te,useMemo:Je,useReducer:St,useRef:At,useState:le,useSyncExternalStore:Mn,useTransition:An,version:ks},Symbol.toStringTag,{value:"Module"}));var Tc=t=>{var{theme:e,settings:n={},styles:o=[]}=t,r={".cm-gutters":{}},i={};n.background&&(i.backgroundColor=n.background),n.backgroundImage&&(i.backgroundImage=n.backgroundImage),n.foreground&&(i.color=n.foreground),n.fontSize&&(i.fontSize=n.fontSize),(n.background||n.foreground)&&(r["&"]=i),n.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:n.fontFamily}),n.gutterBackground&&(r[".cm-gutters"].backgroundColor=n.gutterBackground),n.gutterForeground&&(r[".cm-gutters"].color=n.gutterForeground),n.gutterBorder&&(r[".cm-gutters"].borderRightColor=n.gutterBorder),n.caret&&(r[".cm-content"]={caretColor:n.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n.caret});var s={};n.gutterActiveForeground&&(s.color=n.gutterActiveForeground),n.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:n.lineHighlight},s.backgroundColor=n.lineHighlight),r[".cm-activeLineGutter"]=s,n.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:n.selection+" !important"}),n.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:n.selectionMatch});var l=k.theme(r,{dark:e==="dark"}),a=Oo.define(o),c=[l,ln(a)];return c};function Zt(){return Zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Zt.apply(null,arguments)}function Ss(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;n[o]=t[o]}return n}const As=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),o=Dn(t.state,n.from);return o.line?ws(t):o.block?Ls(t):!1};function Ln(t,e){return({state:n,dispatch:o})=>{if(n.readOnly)return!1;let r=t(e,n);return r?(o(n.update(r)),!0):!1}}const ws=Ln(Ts,0),Ms=Ln(kr,0),Ls=Ln((t,e)=>kr(t,e,Es(e)),0);function Dn(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const Pe=50;function Ds(t,{open:e,close:n},o,r){let i=t.sliceDoc(o-Pe,o),s=t.sliceDoc(r,r+Pe),l=/\s*$/.exec(i)[0].length,a=/^\s*/.exec(s)[0].length,c=i.length-l;if(i.slice(c-e.length,c)==e&&s.slice(a,a+n.length)==n)return{open:{pos:o-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let f,u;r-o<=2*Pe?f=u=t.sliceDoc(o,r):(f=t.sliceDoc(o,o+Pe),u=t.sliceDoc(r-Pe,r));let d=/^\s*/.exec(f)[0].length,h=/\s*$/.exec(u)[0].length,p=u.length-h-n.length;return f.slice(d,d+e.length)==e&&u.slice(p,p+n.length)==n?{open:{pos:o+d+e.length,margin:/\s/.test(f.charAt(d+e.length))?1:0},close:{pos:r-h-n.length,margin:/\s/.test(u.charAt(p-1))?1:0}}:null}function Es(t){let e=[];for(let n of t.selection.ranges){let o=t.doc.lineAt(n.from),r=n.to<=o.to?o:t.doc.lineAt(n.to),i=e.length-1;i>=0&&e[i].to>o.from?e[i].to=r.to:e.push({from:o.from+/^\s*/.exec(o.text)[0].length,to:r.to})}return e}function kr(t,e,n=e.selection.ranges){let o=n.map(i=>Dn(e,i.from).block);if(!o.every(i=>i))return null;let r=n.map((i,s)=>Ds(e,o[s],i.from,i.to));if(t!=2&&!r.every(i=>i))return{changes:e.changes(n.map((i,s)=>r[s]?[]:[{from:i.from,insert:o[s].open+" "},{from:i.to,insert:" "+o[s].close}]))};if(t!=1&&r.some(i=>i)){let i=[];for(let s=0,l;s<r.length;s++)if(l=r[s]){let a=o[s],{open:c,close:f}=l;i.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:f.pos-f.margin,to:f.pos+a.close.length})}return{changes:i}}return null}function Ts(t,e,n=e.selection.ranges){let o=[],r=-1;for(let{from:i,to:s}of n){let l=o.length,a=1e9,c=Dn(e,i).line;if(c){for(let f=i;f<=s;){let u=e.doc.lineAt(f);if(u.from>r&&(i==s||s>u.from)){r=u.from;let d=/^\s*/.exec(u.text)[0].length,h=d==u.length,p=u.text.slice(d,d+c.length)==c?d:-1;d<u.text.length&&d<a&&(a=d),o.push({line:u,comment:p,token:c,indent:d,empty:h,single:!1})}f=u.to+1}if(a<1e9)for(let f=l;f<o.length;f++)o[f].indent<o[f].line.text.length&&(o[f].indent=a);o.length==l+1&&(o[l].single=!0)}}if(t!=2&&o.some(i=>i.comment<0&&(!i.empty||i.single))){let i=[];for(let{line:l,token:a,indent:c,empty:f,single:u}of o)(u||!f)&&i.push({from:l.from+c,insert:a+" "});let s=e.changes(i);return{changes:s,selection:e.selection.map(s,1)}}else if(t!=1&&o.some(i=>i.comment>=0)){let i=[];for(let{line:s,comment:l,token:a}of o)if(l>=0){let c=s.from+l,f=c+a.length;s.text[f-s.from]==" "&&f++,i.push({from:c,to:f})}return{changes:i}}return null}const Xt=xt.define(),Bs=xt.define(),Os=Le.define(),Cr=Le.define({combine(t){return Ke(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(o,r)=>e(o,r)||n(o,r)})}}),Sr=De.define({create(){return Y.empty},update(t,e){let n=e.state.facet(Cr),o=e.annotation(Xt);if(o){let a=N.fromTransaction(e,o.selection),c=o.side,f=c==0?t.undone:t.done;return a?f=ht(f,f.length,n.minDepth,a):f=Mr(f,e.startState.selection),new Y(c==0?o.rest:f,c==0?f:o.rest)}let r=e.annotation(Bs);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(Rt.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let i=N.fromTransaction(e),s=e.annotation(Rt.time),l=e.annotation(Rt.userEvent);return i?t=t.addChanges(i,s,l,n,e):e.selection&&(t=t.addSelection(e.startState.selection,s,l,n.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Y(t.done.map(N.fromJSON),t.undone.map(N.fromJSON))}});function Rs(t={}){return[Sr,Cr.of(t),k.domEventHandlers({beforeinput(e,n){let o=e.inputType=="historyUndo"?Ar:e.inputType=="historyRedo"?en:null;return o?(e.preventDefault(),o(n)):!1}})]}function Mt(t,e){return function({state:n,dispatch:o}){if(!e&&n.readOnly)return!1;let r=n.field(Sr,!1);if(!r)return!1;let i=r.pop(t,n,e);return i?(o(i),!0):!1}}const Ar=Mt(0,!1),en=Mt(1,!1),Is=Mt(0,!0),Ps=Mt(1,!0);class N{constructor(e,n,o,r,i){this.changes=e,this.effects=n,this.mapped=o,this.startSelection=r,this.selectionsAfter=i}setSelAfter(e){return new N(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,o;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(o=this.startSelection)===null||o===void 0?void 0:o.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new N(e.changes&&Li.fromJSON(e.changes),[],e.mapped&&Di.fromJSON(e.mapped),e.startSelection&&_.fromJSON(e.startSelection),e.selectionsAfter.map(_.fromJSON))}static fromTransaction(e,n){let o=z;for(let r of e.startState.facet(Os)){let i=r(e);i.length&&(o=o.concat(i))}return!o.length&&e.changes.empty?null:new N(e.changes.invert(e.startState.doc),o,void 0,n||e.startState.selection,z)}static selection(e){return new N(void 0,z,void 0,void 0,e)}}function ht(t,e,n,o){let r=e+1>n+20?e-n-1:0,i=t.slice(r,e);return i.push(o),i}function $s(t,e){let n=[],o=!1;return t.iterChangedRanges((r,i)=>n.push(r,i)),e.iterChangedRanges((r,i,s,l)=>{for(let a=0;a<n.length;){let c=n[a++],f=n[a++];l>=c&&s<=f&&(o=!0)}}),o}function Ns(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,o)=>n.empty!=e.ranges[o].empty).length===0}function wr(t,e){return t.length?e.length?t.concat(e):t:e}const z=[],Ws=200;function Mr(t,e){if(t.length){let n=t[t.length-1],o=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-Ws));return o.length&&o[o.length-1].eq(e)?t:(o.push(e),ht(t,t.length-1,1e9,n.setSelAfter(o)))}else return[N.selection([e])]}function Fs(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function $t(t,e){if(!t.length)return t;let n=t.length,o=z;for(;n;){let r=Us(t[n-1],e,o);if(r.changes&&!r.changes.empty||r.effects.length){let i=t.slice(0,n);return i[n-1]=r,i}else e=r.mapped,n--,o=r.selectionsAfter}return o.length?[N.selection(o)]:z}function Us(t,e,n){let o=wr(t.selectionsAfter.length?t.selectionsAfter.map(l=>l.map(e)):z,n);if(!t.changes)return N.selection(o);let r=t.changes.map(e),i=e.mapDesc(t.changes,!0),s=t.mapped?t.mapped.composeDesc(i):i;return new N(r,O.mapEffects(t.effects,e),s,t.startSelection.map(i),o)}const Hs=/^(input\.type|delete)($|\.)/;class Y{constructor(e,n,o=0,r=void 0){this.done=e,this.undone=n,this.prevTime=o,this.prevUserEvent=r}isolate(){return this.prevTime?new Y(this.done,this.undone):this}addChanges(e,n,o,r,i){let s=this.done,l=s[s.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!o||Hs.test(o))&&(!l.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(i,$s(l.changes,e.changes))||o=="input.type.compose")?s=ht(s,s.length-1,r.minDepth,new N(e.changes.compose(l.changes),wr(O.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,z)):s=ht(s,s.length,r.minDepth,e),new Y(s,z,n,o)}addSelection(e,n,o,r){let i=this.done.length?this.done[this.done.length-1].selectionsAfter:z;return i.length>0&&n-this.prevTime<r&&o==this.prevUserEvent&&o&&/^select($|\.)/.test(o)&&Ns(i[i.length-1],e)?this:new Y(Mr(this.done,e),this.undone,n,o)}addMapping(e){return new Y($t(this.done,e),$t(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,o){let r=e==0?this.done:this.undone;if(r.length==0)return null;let i=r[r.length-1],s=i.selectionsAfter[0]||n.selection;if(o&&i.selectionsAfter.length)return n.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:Xt.of({side:e,rest:Fs(r),selection:s}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){let l=r.length==1?z:r.slice(0,r.length-1);return i.mapped&&(l=$t(l,i.mapped)),n.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:Xt.of({side:e,rest:l,selection:s}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Y.empty=new Y(z,z);const Vs=[{key:"Mod-z",run:Ar,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:en,preventDefault:!0},{linux:"Ctrl-Shift-z",run:en,preventDefault:!0},{key:"Mod-u",run:Is,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Ps,preventDefault:!0}];function Be(t,e){return _.create(t.ranges.map(e),t.mainIndex)}function te(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function J({state:t,dispatch:e},n){let o=Be(t.selection,n);return o.eq(t.selection,!0)?!1:(e(te(t,o)),!0)}function Lt(t,e){return _.cursor(e?t.to:t.from)}function Lr(t,e){return J(t,n=>n.empty?t.moveByChar(n,e):Lt(n,e))}function I(t){return t.textDirectionAt(t.state.selection.main.head)==No.LTR}const Dr=t=>Lr(t,!I(t)),Er=t=>Lr(t,I(t));function Tr(t,e){return J(t,n=>n.empty?t.moveByGroup(n,e):Lt(n,e))}const zs=t=>Tr(t,!I(t)),qs=t=>Tr(t,I(t));function js(t,e,n){if(e.type.prop(n))return!0;let o=e.to-e.from;return o&&(o>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Dt(t,e,n){let o=Ee(t).resolveInner(e.head),r=n?zt.closedBy:zt.openedBy;for(let a=e.head;;){let c=n?o.childAfter(a):o.childBefore(a);if(!c)break;js(t,c,r)?o=c:a=n?c.to:c.from}let i=o.type.prop(r),s,l;return i&&(s=n?be(t,o.from,1):be(t,o.to,-1))&&s.matched?l=n?s.end.to:s.end.from:l=n?o.to:o.from,_.cursor(l,n?-1:1)}const Ks=t=>J(t,e=>Dt(t.state,e,!I(t))),Gs=t=>J(t,e=>Dt(t.state,e,I(t)));function Br(t,e){return J(t,n=>{if(!n.empty)return Lt(n,e);let o=t.moveVertically(n,e);return o.head!=n.head?o:t.moveToLineBoundary(n,e)})}const Or=t=>Br(t,!1),Rr=t=>Br(t,!0);function Ir(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,o=0,r;if(e){for(let i of t.state.facet(k.scrollMargins)){let s=i(t);s!=null&&s.top&&(n=Math.max(s==null?void 0:s.top,n)),s!=null&&s.bottom&&(o=Math.max(s==null?void 0:s.bottom,o))}r=t.scrollDOM.clientHeight-n-o}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:o,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function Pr(t,e){let n=Ir(t),{state:o}=t,r=Be(o.selection,s=>s.empty?t.moveVertically(s,e,n.height):Lt(s,e));if(r.eq(o.selection))return!1;let i;if(n.selfScroll){let s=t.coordsAtPos(o.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),a=l.top+n.marginTop,c=l.bottom-n.marginBottom;s&&s.top>a&&s.bottom<c&&(i=k.scrollIntoView(r.main.head,{y:"start",yMargin:s.top-a}))}return t.dispatch(te(o,r),{effects:i}),!0}const ro=t=>Pr(t,!1),tn=t=>Pr(t,!0);function ue(t,e,n){let o=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?o.to:o.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==o.from&&o.length){let i=/^\s*/.exec(t.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;i&&e.head!=o.from+i&&(r=_.cursor(o.from+i))}return r}const Js=t=>J(t,e=>ue(t,e,!0)),Qs=t=>J(t,e=>ue(t,e,!1)),Ys=t=>J(t,e=>ue(t,e,!I(t))),Zs=t=>J(t,e=>ue(t,e,I(t))),Xs=t=>J(t,e=>_.cursor(t.lineBlockAt(e.head).from,1)),el=t=>J(t,e=>_.cursor(t.lineBlockAt(e.head).to,-1));function tl(t,e,n){let o=!1,r=Be(t.selection,i=>{let s=be(t,i.head,-1)||be(t,i.head,1)||i.head>0&&be(t,i.head-1,1)||i.head<t.doc.length&&be(t,i.head+1,-1);if(!s||!s.end)return i;o=!0;let l=s.start.from==i.head?s.end.to:s.end.from;return _.cursor(l)});return o?(e(te(t,r)),!0):!1}const nl=({state:t,dispatch:e})=>tl(t,e);function q(t,e){let n=Be(t.state.selection,o=>{let r=e(o);return _.range(o.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(te(t.state,n)),!0)}function $r(t,e){return q(t,n=>t.moveByChar(n,e))}const Nr=t=>$r(t,!I(t)),Wr=t=>$r(t,I(t));function Fr(t,e){return q(t,n=>t.moveByGroup(n,e))}const ol=t=>Fr(t,!I(t)),rl=t=>Fr(t,I(t)),il=t=>q(t,e=>Dt(t.state,e,!I(t))),sl=t=>q(t,e=>Dt(t.state,e,I(t)));function Ur(t,e){return q(t,n=>t.moveVertically(n,e))}const Hr=t=>Ur(t,!1),Vr=t=>Ur(t,!0);function zr(t,e){return q(t,n=>t.moveVertically(n,e,Ir(t).height))}const io=t=>zr(t,!1),so=t=>zr(t,!0),ll=t=>q(t,e=>ue(t,e,!0)),al=t=>q(t,e=>ue(t,e,!1)),cl=t=>q(t,e=>ue(t,e,!I(t))),ul=t=>q(t,e=>ue(t,e,I(t))),fl=t=>q(t,e=>_.cursor(t.lineBlockAt(e.head).from)),hl=t=>q(t,e=>_.cursor(t.lineBlockAt(e.head).to)),lo=({state:t,dispatch:e})=>(e(te(t,{anchor:0})),!0),ao=({state:t,dispatch:e})=>(e(te(t,{anchor:t.doc.length})),!0),co=({state:t,dispatch:e})=>(e(te(t,{anchor:t.selection.main.anchor,head:0})),!0),uo=({state:t,dispatch:e})=>(e(te(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),dl=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),pl=({state:t,dispatch:e})=>{let n=Et(t).map(({from:o,to:r})=>_.range(o,Math.min(r+1,t.doc.length)));return e(t.update({selection:_.create(n),userEvent:"select"})),!0},ml=({state:t,dispatch:e})=>{let n=Be(t.selection,o=>{var r;let i=Ee(t).resolveStack(o.from,1);for(let s=i;s;s=s.next){let{node:l}=s;if((l.from<o.from&&l.to>=o.to||l.to>o.to&&l.from<=o.from)&&(!((r=l.parent)===null||r===void 0)&&r.parent))return _.range(l.to,l.from)}return o});return e(te(t,n)),!0},gl=({state:t,dispatch:e})=>{let n=t.selection,o=null;return n.ranges.length>1?o=_.create([n.main]):n.main.empty||(o=_.create([_.cursor(n.main.head)])),o?(e(te(t,o)),!0):!1};function Ye(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:o}=t,r=o.changeByRange(i=>{let{from:s,to:l}=i;if(s==l){let a=e(i);a<s?(n="delete.backward",a=tt(t,a,!1)):a>s&&(n="delete.forward",a=tt(t,a,!0)),s=Math.min(s,a),l=Math.max(l,a)}else s=tt(t,s,!1),l=tt(t,l,!0);return s==l?{range:i}:{changes:{from:s,to:l},range:_.cursor(s,s<i.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(o.update(r,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?k.announce.of(o.phrase("Selection deleted")):void 0})),!0)}function tt(t,e,n){if(t instanceof k)for(let o of t.state.facet(k.atomicRanges).map(r=>r(t)))o.between(e,e,(r,i)=>{r<e&&i>e&&(e=n?i:r)});return e}const qr=(t,e,n)=>Ye(t,o=>{let r=o.from,{state:i}=t,s=i.doc.lineAt(r),l,a;if(n&&!e&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,r-s.from))){if(l[l.length-1]=="	")return r-1;let c=an(l,i.tabSize),f=c%Vt(i)||Vt(i);for(let u=0;u<f&&l[l.length-1-u]==" ";u++)r--;a=r}else a=pe(s.text,r-s.from,e,e)+s.from,a==r&&s.number!=(e?i.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(a-s.from,r-s.from))&&(a=pe(s.text,a-s.from,!1,!1)+s.from);return a}),nn=t=>qr(t,!1,!0),jr=t=>qr(t,!0,!1),Kr=(t,e)=>Ye(t,n=>{let o=n.head,{state:r}=t,i=r.doc.lineAt(o),s=r.charCategorizer(o);for(let l=null;;){if(o==(e?i.to:i.from)){o==n.head&&i.number!=(e?r.doc.lines:1)&&(o+=e?1:-1);break}let a=pe(i.text,o-i.from,e)+i.from,c=i.text.slice(Math.min(o,a)-i.from,Math.max(o,a)-i.from),f=s(c);if(l!=null&&f!=l)break;(c!=" "||o!=n.head)&&(l=f),o=a}return o}),Gr=t=>Kr(t,!1),_l=t=>Kr(t,!0),yl=t=>Ye(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),vl=t=>Ye(t,e=>{let n=t.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),bl=t=>Ye(t,e=>{let n=t.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),xl=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(o=>({changes:{from:o.from,to:o.to,insert:Po.of(["",""])},range:_.cursor(o.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},kl=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(o=>{if(!o.empty||o.from==0||o.from==t.doc.length)return{range:o};let r=o.from,i=t.doc.lineAt(r),s=r==i.from?r-1:pe(i.text,r-i.from,!1)+i.from,l=r==i.to?r+1:pe(i.text,r-i.from,!0)+i.from;return{changes:{from:s,to:l,insert:t.doc.slice(r,l).append(t.doc.slice(s,r))},range:_.cursor(l)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Et(t){let e=[],n=-1;for(let o of t.selection.ranges){let r=t.doc.lineAt(o.from),i=t.doc.lineAt(o.to);if(!o.empty&&o.to==i.from&&(i=t.doc.lineAt(o.to-1)),n>=r.number){let s=e[e.length-1];s.to=i.to,s.ranges.push(o)}else e.push({from:r.from,to:i.to,ranges:[o]});n=i.number+1}return e}function Jr(t,e,n){if(t.readOnly)return!1;let o=[],r=[];for(let i of Et(t)){if(n?i.to==t.doc.length:i.from==0)continue;let s=t.doc.lineAt(n?i.to+1:i.from-1),l=s.length+1;if(n){o.push({from:i.to,to:s.to},{from:i.from,insert:s.text+t.lineBreak});for(let a of i.ranges)r.push(_.range(Math.min(t.doc.length,a.anchor+l),Math.min(t.doc.length,a.head+l)))}else{o.push({from:s.from,to:i.from},{from:i.to,insert:t.lineBreak+s.text});for(let a of i.ranges)r.push(_.range(a.anchor-l,a.head-l))}}return o.length?(e(t.update({changes:o,scrollIntoView:!0,selection:_.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Cl=({state:t,dispatch:e})=>Jr(t,e,!1),Sl=({state:t,dispatch:e})=>Jr(t,e,!0);function Qr(t,e,n){if(t.readOnly)return!1;let o=[];for(let r of Et(t))n?o.push({from:r.from,insert:t.doc.slice(r.from,r.to)+t.lineBreak}):o.push({from:r.to,insert:t.lineBreak+t.doc.slice(r.from,r.to)});return e(t.update({changes:o,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Al=({state:t,dispatch:e})=>Qr(t,e,!1),wl=({state:t,dispatch:e})=>Qr(t,e,!0),Ml=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(Et(e).map(({from:r,to:i})=>(r>0?r--:i<e.doc.length&&i++,{from:r,to:i}))),o=Be(e.selection,r=>{let i;if(t.lineWrapping){let s=t.lineBlockAt(r.head),l=t.coordsAtPos(r.head,r.assoc||1);l&&(i=s.bottom+t.documentTop-l.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,i)}).map(n);return t.dispatch({changes:n,selection:o,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Ll(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=Ee(t).resolveInner(e),o=n.childBefore(e),r=n.childAfter(e),i;return o&&r&&o.to<=e&&r.from>=e&&(i=o.type.prop(zt.closedBy))&&i.indexOf(r.name)>-1&&t.doc.lineAt(o.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(o.to,r.from))?{from:o.to,to:r.from}:null}const Dl=Yr(!1),El=Yr(!0);function Yr(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let o=e.changeByRange(r=>{let{from:i,to:s}=r,l=e.doc.lineAt(i),a=!t&&i==s&&Ll(e,i);t&&(i=s=(s<=l.to?l:e.doc.lineAt(s)).to);let c=new Ro(e,{simulateBreak:i,simulateDoubleBreak:!!a}),f=Io(c,i);for(f==null&&(f=an(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));s<l.to&&/\s/.test(l.text[s-l.from]);)s++;a?{from:i,to:s}=a:i>l.from&&i<l.from+100&&!/\S/.test(l.text.slice(0,i))&&(i=l.from);let u=["",at(e,f)];return a&&u.push(at(e,c.lineIndent(l.from,-1))),{changes:{from:i,to:s,insert:Po.of(u)},range:_.cursor(i+1+u[1].length)}});return n(e.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}}function En(t,e){let n=-1;return t.changeByRange(o=>{let r=[];for(let s=o.from;s<=o.to;){let l=t.doc.lineAt(s);l.number>n&&(o.empty||o.to>l.from)&&(e(l,r,o),n=l.number),s=l.to+1}let i=t.changes(r);return{changes:r,range:_.range(i.mapPos(o.anchor,1),i.mapPos(o.head,1))}})}const Tl=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=Object.create(null),o=new Ro(t,{overrideIndentation:i=>{let s=n[i];return s??-1}}),r=En(t,(i,s,l)=>{let a=Io(o,i.from);if(a==null)return;/\S/.test(i.text)||(a=0);let c=/^\s*/.exec(i.text)[0],f=at(t,a);(c!=f||l.from<i.from+c.length)&&(n[i.from]=a,s.push({from:i.from,to:i.from+c.length,insert:f}))});return r.changes.empty||e(t.update(r,{userEvent:"indent"})),!0},Zr=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(En(t,(n,o)=>{o.push({from:n.from,insert:t.facet($o)})}),{userEvent:"input.indent"})),!0),Xr=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(En(t,(n,o)=>{let r=/^\s*/.exec(n.text)[0];if(!r)return;let i=an(r,t.tabSize),s=0,l=at(t,Math.max(0,i-Vt(t)));for(;s<r.length&&s<l.length&&r.charCodeAt(s)==l.charCodeAt(s);)s++;o.push({from:n.from+s,to:n.from+r.length,insert:l.slice(s)})}),{userEvent:"delete.dedent"})),!0),Bl=t=>(t.setTabFocusMode(),!0),Ol=[{key:"Ctrl-b",run:Dr,shift:Nr,preventDefault:!0},{key:"Ctrl-f",run:Er,shift:Wr},{key:"Ctrl-p",run:Or,shift:Hr},{key:"Ctrl-n",run:Rr,shift:Vr},{key:"Ctrl-a",run:Xs,shift:fl},{key:"Ctrl-e",run:el,shift:hl},{key:"Ctrl-d",run:jr},{key:"Ctrl-h",run:nn},{key:"Ctrl-k",run:yl},{key:"Ctrl-Alt-h",run:Gr},{key:"Ctrl-o",run:xl},{key:"Ctrl-t",run:kl},{key:"Ctrl-v",run:tn}],Rl=[{key:"ArrowLeft",run:Dr,shift:Nr,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:zs,shift:ol,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ys,shift:cl,preventDefault:!0},{key:"ArrowRight",run:Er,shift:Wr,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:qs,shift:rl,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Zs,shift:ul,preventDefault:!0},{key:"ArrowUp",run:Or,shift:Hr,preventDefault:!0},{mac:"Cmd-ArrowUp",run:lo,shift:co},{mac:"Ctrl-ArrowUp",run:ro,shift:io},{key:"ArrowDown",run:Rr,shift:Vr,preventDefault:!0},{mac:"Cmd-ArrowDown",run:ao,shift:uo},{mac:"Ctrl-ArrowDown",run:tn,shift:so},{key:"PageUp",run:ro,shift:io},{key:"PageDown",run:tn,shift:so},{key:"Home",run:Qs,shift:al,preventDefault:!0},{key:"Mod-Home",run:lo,shift:co},{key:"End",run:Js,shift:ll,preventDefault:!0},{key:"Mod-End",run:ao,shift:uo},{key:"Enter",run:Dl},{key:"Mod-a",run:dl},{key:"Backspace",run:nn,shift:nn},{key:"Delete",run:jr},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Gr},{key:"Mod-Delete",mac:"Alt-Delete",run:_l},{mac:"Mod-Backspace",run:vl},{mac:"Mod-Delete",run:bl}].concat(Ol.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),Il=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Ks,shift:il},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Gs,shift:sl},{key:"Alt-ArrowUp",run:Cl},{key:"Shift-Alt-ArrowUp",run:Al},{key:"Alt-ArrowDown",run:Sl},{key:"Shift-Alt-ArrowDown",run:wl},{key:"Escape",run:gl},{key:"Mod-Enter",run:El},{key:"Alt-l",mac:"Ctrl-l",run:pl},{key:"Mod-i",run:ml,preventDefault:!0},{key:"Mod-[",run:Xr},{key:"Mod-]",run:Zr},{key:"Mod-Alt-\\",run:Tl},{key:"Shift-Mod-k",run:Ml},{key:"Shift-Mod-\\",run:nl},{key:"Mod-/",run:As},{key:"Alt-A",run:Ms},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Bl}].concat(Rl),Pl={key:"Tab",run:Zr,shift:Xr};function S(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=n[o];typeof r=="string"?t.setAttribute(o,r):r!=null&&(t[o]=r)}e++}for(;e<arguments.length;e++)ei(t,arguments[e]);return t}function ei(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)ei(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const fo=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class we{constructor(e,n,o=0,r=e.length,i,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(o,r),this.bufferStart=o,this.normalize=i?l=>i(fo(l)):fo,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return V(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=un(e),o=this.bufferStart+this.bufferPos;this.bufferPos+=oe(e);let r=this.normalize(n);for(let i=0,s=o;;i++){let l=r.charCodeAt(i),a=this.match(l,s,this.bufferPos+this.bufferStart);if(i==r.length-1){if(a)return this.value=a,this;break}s==o&&i<n.length&&n.charCodeAt(i)==l&&s++}}}match(e,n,o){let r=null;for(let i=0;i<this.matches.length;i+=2){let s=this.matches[i],l=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?r={from:this.matches[i+1],to:o}:(this.matches[i]++,l=!0)),l||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:o}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(we.prototype[Symbol.iterator]=function(){return this});const ti={from:-1,to:-1,match:/.*/.exec("")},Tn="gm"+(/x/.unicode==null?"":"u");class ni{constructor(e,n,o,r=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=ti,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new oi(e,n,o,r,i);this.re=new RegExp(n,Tn+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.iter=e.iter();let s=e.lineAt(r);this.curLineStart=s.from,this.matchPos=dt(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let o=this.curLineStart+n.index,r=o+n[0].length;if(this.matchPos=dt(this.text,r+(o==r?1:0)),o==this.curLineStart+this.curLine.length&&this.nextLine(),(o<r||o>this.value.to)&&(!this.test||this.test(o,r,n)))return this.value={from:o,to:r,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Nt=new WeakMap;class Ce{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,o){let r=Nt.get(e);if(!r||r.from>=o||r.to<=n){let l=new Ce(n,e.sliceString(n,o));return Nt.set(e,l),l}if(r.from==n&&r.to==o)return r;let{text:i,from:s}=r;return s>n&&(i=e.sliceString(n,s)+i,s=n),r.to<o&&(i+=e.sliceString(r.to,o)),Nt.set(e,new Ce(s,i)),new Ce(n,i.slice(n-s,o-s))}}class oi{constructor(e,n,o,r,i){this.text=e,this.to=i,this.done=!1,this.value=ti,this.matchPos=dt(e,r),this.re=new RegExp(n,Tn+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.flat=Ce.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let o=this.flat.from+n.index,r=o+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(o,r,n)))return this.value={from:o,to:r,match:n},this.matchPos=dt(this.text,r+(o==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ce.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(ni.prototype[Symbol.iterator]=oi.prototype[Symbol.iterator]=function(){return this});function $l(t){try{return new RegExp(t,Tn),!0}catch{return!1}}function dt(t,e){if(e>=t.length)return e;let n=t.lineAt(e),o;for(;e<n.to&&(o=n.text.charCodeAt(e-n.from))>=56320&&o<57344;)e++;return e}function on(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=S("input",{class:"cm-textfield",name:"line",value:e}),o=S("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:pt.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),r())},onsubmit:i=>{i.preventDefault(),r()}},S("label",t.state.phrase("Go to line"),": ",n)," ",S("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function r(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!i)return;let{state:s}=t,l=s.doc.lineAt(s.selection.main.head),[,a,c,f,u]=i,d=f?+f.slice(1):0,h=c?+c:l.number;if(c&&u){let x=h/100;a&&(x=x*(a=="-"?-1:1)+l.number/s.doc.lines),h=Math.round(s.doc.lines*x)}else c&&a&&(h=h*(a=="-"?-1:1)+l.number);let p=s.doc.line(Math.max(1,Math.min(s.doc.lines,h))),b=_.cursor(p.from+Math.max(0,Math.min(d,p.length)));t.dispatch({effects:[pt.of(!1),k.scrollIntoView(b.from,{y:"center"})],selection:b}),t.focus()}return{dom:o}}const pt=O.define(),ho=De.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(pt)&&(t=n.value);return t},provide:t=>fn.from(t,e=>e?on:null)}),Nl=t=>{let e=We(t,on);if(!e){let n=[pt.of(!0)];t.state.field(ho,!1)==null&&n.push(O.appendConfig.of([ho,Wl])),t.dispatch({effects:n}),e=We(t,on)}return e&&e.dom.querySelector("input").select(),!0},Wl=k.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Fl={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Ul=Le.define({combine(t){return Ke(t,Fl,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function Hl(t){return[Kl,jl]}const Vl=E.mark({class:"cm-selectionMatch"}),zl=E.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function po(t,e,n,o){return(n==0||t(e.sliceDoc(n-1,n))!=P.Word)&&(o==e.doc.length||t(e.sliceDoc(o,o+1))!=P.Word)}function ql(t,e,n,o){return t(e.sliceDoc(n,n+1))==P.Word&&t(e.sliceDoc(o-1,o))==P.Word}const jl=kt.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(Ul),{state:n}=t,o=n.selection;if(o.ranges.length>1)return E.none;let r=o.main,i,s=null;if(r.empty){if(!e.highlightWordAroundCursor)return E.none;let a=n.wordAt(r.head);if(!a)return E.none;s=n.charCategorizer(r.head),i=n.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return E.none;if(e.wholeWords){if(i=n.sliceDoc(r.from,r.to),s=n.charCategorizer(r.head),!(po(s,n,r.from,r.to)&&ql(s,n,r.from,r.to)))return E.none}else if(i=n.sliceDoc(r.from,r.to),!i)return E.none}let l=[];for(let a of t.visibleRanges){let c=new we(n.doc,i,a.from,a.to);for(;!c.next().done;){let{from:f,to:u}=c.value;if((!s||po(s,n,f,u))&&(r.empty&&f<=r.from&&u>=r.to?l.push(zl.range(f,u)):(f>=r.to||u<=r.from)&&l.push(Vl.range(f,u)),l.length>e.maxMatches))return E.none}}return E.set(l)}},{decorations:t=>t.decorations}),Kl=k.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Gl=({state:t,dispatch:e})=>{let{selection:n}=t,o=_.create(n.ranges.map(r=>t.wordAt(r.head)||_.cursor(r.head)),n.mainIndex);return o.eq(n)?!1:(e(t.update({selection:o})),!0)};function Jl(t,e){let{main:n,ranges:o}=t.selection,r=t.wordAt(n.head),i=r&&r.from==n.from&&r.to==n.to;for(let s=!1,l=new we(t.doc,e,o[o.length-1].to);;)if(l.next(),l.done){if(s)return null;l=new we(t.doc,e,0,Math.max(0,o[o.length-1].from-1)),s=!0}else{if(s&&o.some(a=>a.from==l.value.from))continue;if(i){let a=t.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const Ql=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(i=>i.from===i.to))return Gl({state:t,dispatch:e});let o=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(i=>t.sliceDoc(i.from,i.to)!=o))return!1;let r=Jl(t,o);return r?(e(t.update({selection:t.selection.addRange(_.range(r.from,r.to),!1),effects:k.scrollIntoView(r.to)})),!0):!1},Oe=Le.define({combine(t){return Ke(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new aa(e),scrollToMatch:e=>k.scrollIntoView(e)})}});class ri{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||$l(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,o)=>o=="n"?`
`:o=="r"?"\r":o=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new ea(this):new Zl(this)}getCursor(e,n=0,o){let r=e.doc?e:Fe.create({doc:e});return o==null&&(o=r.doc.length),this.regexp?ve(this,r,n,o):ye(this,r,n,o)}}class ii{constructor(e){this.spec=e}}function ye(t,e,n,o){return new we(e.doc,t.unquoted,n,o,t.caseSensitive?void 0:r=>r.toLowerCase(),t.wholeWord?Yl(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Yl(t,e){return(n,o,r,i)=>((i>n||i+r.length<o)&&(i=Math.max(0,n-2),r=t.sliceString(i,Math.min(t.length,o+2))),(e(mt(r,n-i))!=P.Word||e(gt(r,n-i))!=P.Word)&&(e(gt(r,o-i))!=P.Word||e(mt(r,o-i))!=P.Word))}class Zl extends ii{constructor(e){super(e)}nextMatch(e,n,o){let r=ye(this.spec,e,o,e.doc.length).nextOverlapping();return r.done&&(r=ye(this.spec,e,0,n).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,n,o){for(let r=o;;){let i=Math.max(n,r-1e4-this.spec.unquoted.length),s=ye(this.spec,e,i,r),l=null;for(;!s.nextOverlapping().done;)l=s.value;if(l)return l;if(i==n)return null;r-=1e4}}prevMatch(e,n,o){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let o=ye(this.spec,e,0,e.doc.length),r=[];for(;!o.next().done;){if(r.length>=n)return null;r.push(o.value)}return r}highlight(e,n,o,r){let i=ye(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(o+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)r(i.value.from,i.value.to)}}function ve(t,e,n,o){return new ni(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?Xl(e.charCategorizer(e.selection.main.head)):void 0},n,o)}function mt(t,e){return t.slice(pe(t,e,!1),e)}function gt(t,e){return t.slice(e,pe(t,e))}function Xl(t){return(e,n,o)=>!o[0].length||(t(mt(o.input,o.index))!=P.Word||t(gt(o.input,o.index))!=P.Word)&&(t(gt(o.input,o.index+o[0].length))!=P.Word||t(mt(o.input,o.index+o[0].length))!=P.Word)}class ea extends ii{nextMatch(e,n,o){let r=ve(this.spec,e,o,e.doc.length).next();return r.done&&(r=ve(this.spec,e,0,n).next()),r.done?null:r.value}prevMatchInRange(e,n,o){for(let r=1;;r++){let i=Math.max(n,o-r*1e4),s=ve(this.spec,e,i,o),l=null;for(;!s.next().done;)l=s.value;if(l&&(i==n||l.from>i+10))return l;if(i==n)return null}}prevMatch(e,n,o){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,o)=>o=="$"?"$":o=="&"?e.match[0]:o!="0"&&+o<e.match.length?e.match[o]:n)}matchAll(e,n){let o=ve(this.spec,e,0,e.doc.length),r=[];for(;!o.next().done;){if(r.length>=n)return null;r.push(o.value)}return r}highlight(e,n,o,r){let i=ve(this.spec,e,Math.max(0,n-250),Math.min(o+250,e.doc.length));for(;!i.next().done;)r(i.value.from,i.value.to)}}const Ve=O.define(),Bn=O.define(),ae=De.define({create(t){return new Wt(rn(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Ve)?t=new Wt(n.value.create(),t.panel):n.is(Bn)&&(t=new Wt(t.query,n.value?On:null));return t},provide:t=>fn.from(t,e=>e.panel)});class Wt{constructor(e,n){this.query=e,this.panel=n}}const ta=E.mark({class:"cm-searchMatch"}),na=E.mark({class:"cm-searchMatch cm-searchMatch-selected"}),oa=kt.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(ae))}update(t){let e=t.state.field(ae);(e!=t.startState.field(ae)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return E.none;let{view:n}=this,o=new Ei;for(let r=0,i=n.visibleRanges,s=i.length;r<s;r++){let{from:l,to:a}=i[r];for(;r<s-1&&a>i[r+1].from-2*250;)a=i[++r].to;t.highlight(n.state,l,a,(c,f)=>{let u=n.state.selection.ranges.some(d=>d.from==c&&d.to==f);o.add(c,f,u?na:ta)})}return o.finish()}},{decorations:t=>t.decorations});function Ze(t){return e=>{let n=e.state.field(ae,!1);return n&&n.query.spec.valid?t(e,n):ai(e)}}const _t=Ze((t,{query:e})=>{let{to:n}=t.state.selection.main,o=e.nextMatch(t.state,n,n);if(!o)return!1;let r=_.single(o.from,o.to),i=t.state.facet(Oe);return t.dispatch({selection:r,effects:[Rn(t,o),i.scrollToMatch(r.main,t)],userEvent:"select.search"}),li(t),!0}),yt=Ze((t,{query:e})=>{let{state:n}=t,{from:o}=n.selection.main,r=e.prevMatch(n,o,o);if(!r)return!1;let i=_.single(r.from,r.to),s=t.state.facet(Oe);return t.dispatch({selection:i,effects:[Rn(t,r),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),li(t),!0}),ra=Ze((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:_.create(n.map(o=>_.range(o.from,o.to))),userEvent:"select.search.matches"}),!0)}),ia=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:o,to:r}=n.main,i=[],s=0;for(let l=new we(t.doc,t.sliceDoc(o,r));!l.next().done;){if(i.length>1e3)return!1;l.value.from==o&&(s=i.length),i.push(_.range(l.value.from,l.value.to))}return e(t.update({selection:_.create(i,s),userEvent:"select.search.matches"})),!0},mo=Ze((t,{query:e})=>{let{state:n}=t,{from:o,to:r}=n.selection.main;if(n.readOnly)return!1;let i=e.nextMatch(n,o,o);if(!i)return!1;let s=[],l,a,c=[];if(i.from==o&&i.to==r&&(a=n.toText(e.getReplacement(i)),s.push({from:i.from,to:i.to,insert:a}),i=e.nextMatch(n,i.from,i.to),c.push(k.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(o).number)+"."))),i){let f=s.length==0||s[0].from>=i.to?0:i.to-i.from-a.length;l=_.single(i.from-f,i.to-f),c.push(Rn(t,i)),c.push(n.facet(Oe).scrollToMatch(l.main,t))}return t.dispatch({changes:s,selection:l,effects:c,userEvent:"input.replace"}),!0}),sa=Ze((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(r=>{let{from:i,to:s}=r;return{from:i,to:s,insert:e.getReplacement(r)}});if(!n.length)return!1;let o=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:k.announce.of(o),userEvent:"input.replace.all"}),!0});function On(t){return t.state.facet(Oe).createPanel(t)}function rn(t,e){var n,o,r,i,s;let l=t.selection.main,a=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=t.facet(Oe);return new ri({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(o=e==null?void 0:e.caseSensitive)!==null&&o!==void 0?o:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(i=e==null?void 0:e.regexp)!==null&&i!==void 0?i:c.regexp,wholeWord:(s=e==null?void 0:e.wholeWord)!==null&&s!==void 0?s:c.wholeWord})}function si(t){let e=We(t,On);return e&&e.dom.querySelector("[main-field]")}function li(t){let e=si(t);e&&e==t.root.activeElement&&e.select()}const ai=t=>{let e=t.state.field(ae,!1);if(e&&e.panel){let n=si(t);if(n&&n!=t.root.activeElement){let o=rn(t.state,e.query.spec);o.valid&&t.dispatch({effects:Ve.of(o)}),n.focus(),n.select()}}else t.dispatch({effects:[Bn.of(!0),e?Ve.of(rn(t.state,e.query.spec)):O.appendConfig.of(ua)]});return!0},ci=t=>{let e=t.state.field(ae,!1);if(!e||!e.panel)return!1;let n=We(t,On);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:Bn.of(!1)}),!0},la=[{key:"Mod-f",run:ai,scope:"editor search-panel"},{key:"F3",run:_t,shift:yt,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:_t,shift:yt,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:ci,scope:"editor search-panel"},{key:"Mod-Shift-l",run:ia},{key:"Mod-Alt-g",run:Nl},{key:"Mod-d",run:Ql,preventDefault:!0}];class aa{constructor(e){this.view=e;let n=this.query=e.state.field(ae).query.spec;this.commit=this.commit.bind(this),this.searchField=S("input",{value:n.search,placeholder:F(e,"Find"),"aria-label":F(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=S("input",{value:n.replace,placeholder:F(e,"Replace"),"aria-label":F(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=S("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=S("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=S("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function o(r,i,s){return S("button",{class:"cm-button",name:r,onclick:i,type:"button"},s)}this.dom=S("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,o("next",()=>_t(e),[F(e,"next")]),o("prev",()=>yt(e),[F(e,"previous")]),o("select",()=>ra(e),[F(e,"all")]),S("label",null,[this.caseField,F(e,"match case")]),S("label",null,[this.reField,F(e,"regexp")]),S("label",null,[this.wordField,F(e,"by word")]),...e.state.readOnly?[]:[S("br"),this.replaceField,o("replace",()=>mo(e),[F(e,"replace")]),o("replaceAll",()=>sa(e),[F(e,"replace all")])],S("button",{name:"close",onclick:()=>ci(e),"aria-label":F(e,"close"),type:"button"},[""])])}commit(){let e=new ri({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ve.of(e)}))}keydown(e){Ti(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?yt:_t)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),mo(this.view))}update(e){for(let n of e.transactions)for(let o of n.effects)o.is(Ve)&&!o.value.eq(this.query)&&this.setQuery(o.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Oe).top}}function F(t,e){return t.state.phrase(e)}const nt=30,ot=/[\s\.,:;?!]/;function Rn(t,{from:e,to:n}){let o=t.state.doc.lineAt(e),r=t.state.doc.lineAt(n).to,i=Math.max(o.from,e-nt),s=Math.min(r,n+nt),l=t.state.sliceDoc(i,s);if(i!=o.from){for(let a=0;a<nt;a++)if(!ot.test(l[a+1])&&ot.test(l[a])){l=l.slice(a);break}}if(s!=r){for(let a=l.length-1;a>l.length-nt;a--)if(!ot.test(l[a-1])&&ot.test(l[a])){l=l.slice(0,a);break}}return k.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${o.number}.`)}const ca=k.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),ua=[ae,cn.low(oa),ca];class ui{constructor(e,n,o,r){this.state=e,this.pos=n,this.explicit=o,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=Ee(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),o=Math.max(n.from,this.pos-250),r=n.text.slice(o-n.from,this.pos-n.from),i=r.search(fi(e,!1));return i<0?null:{from:o+i,to:this.pos,text:r.slice(i)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,o){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),o&&o.onDocChange&&(this.abortOnDocChange=!0))}}function go(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function fa(t){let e=Object.create(null),n=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let i=1;i<r.length;i++)n[r[i]]=!0}let o=go(e)+go(n)+"*$";return[new RegExp("^"+o),new RegExp(o)]}function ha(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[n,o]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:fa(e);return r=>{let i=r.matchBefore(o);return i||r.explicit?{from:i?i.from:r.pos,options:e,validFor:n}:null}}class _o{constructor(e,n,o,r){this.completion=e,this.source=n,this.match=o,this.score=r}}function ce(t){return t.selection.main.from}function fi(t,e){var n;let{source:o}=t,r=e&&o[0]!="^",i=o[o.length-1]!="$";return!r&&!i?t:new RegExp(`${r?"^":""}(?:${o})${i?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const hi=xt.define();function da(t,e,n,o){let{main:r}=t.selection,i=n-r.from,s=o-r.from;return Object.assign(Object.assign({},t.changeByRange(l=>l!=r&&n!=o&&t.sliceDoc(l.from+i,l.from+s)!=t.sliceDoc(n,o)?{range:l}:{changes:{from:l.from+i,to:o==r.from?l.to:l.from+s,insert:e},range:_.cursor(l.from+i+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const yo=new WeakMap;function pa(t){if(!Array.isArray(t))return t;let e=yo.get(t);return e||yo.set(t,e=ha(t)),e}const vt=O.define(),ze=O.define();class ma{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let o=V(e,n),r=oe(o);this.chars.push(o);let i=e.slice(n,n+r),s=i.toUpperCase();this.folded.push(V(s==i?i.toLowerCase():s,0)),n+=r}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:o,any:r,precise:i,byWord:s}=this;if(n.length==1){let m=V(e,0),T=oe(m),A=T==e.length?0:-100;if(m!=n[0])if(m==o[0])A+=-200;else return null;return this.ret(A,[0,T])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=n.length,c=0;if(l<0){for(let m=0,T=Math.min(e.length,200);m<T&&c<a;){let A=V(e,m);(A==n[c]||A==o[c])&&(r[c++]=m),m+=oe(A)}if(c<a)return null}let f=0,u=0,d=!1,h=0,p=-1,b=-1,x=/[a-z]/.test(e),v=!0;for(let m=0,T=Math.min(e.length,200),A=0;m<T&&u<a;){let w=V(e,m);l<0&&(f<a&&w==n[f]&&(i[f++]=m),h<a&&(w==n[h]||w==o[h]?(h==0&&(p=m),b=m+1,h++):h=0));let R,W=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(R=un(w))!=R.toLowerCase()?1:R!=R.toUpperCase()?2:0;(!m||W==1&&x||A==0&&W!=0)&&(n[u]==w||o[u]==w&&(d=!0)?s[u++]=m:s.length&&(v=!1)),A=W,m+=oe(w)}return u==a&&s[0]==0&&v?this.result(-100+(d?-200:0),s,e):h==a&&p==0?this.ret(-200-e.length+(b==e.length?0:-100),[0,b]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):h==a?this.ret(-900-e.length,[p,b]):u==a?this.result(-100+(d?-200:0)+-700+(v?0:-1100),s,e):n.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,n,o){let r=[],i=0;for(let s of n){let l=s+(this.astral?oe(V(o,s)):1);i&&r[i-1]==s?r[i-1]=l:(r[i++]=s,r[i++]=l)}return this.ret(e-o.length,r)}}class ga{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),o=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return o==null?null:(this.matched=[0,n.length],this.score=o+(e.length==this.pattern.length?0:-100),this)}}const B=Le.define({combine(t){return Ke(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:_a,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>o=>vo(e(o),n(o)),optionClass:(e,n)=>o=>vo(e(o),n(o)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function vo(t,e){return t?e?t+" "+e:t:e}function _a(t,e,n,o,r,i){let s=t.textDirection==No.RTL,l=s,a=!1,c="top",f,u,d=e.left-r.left,h=r.right-e.right,p=o.right-o.left,b=o.bottom-o.top;if(l&&d<Math.min(p,h)?l=!1:!l&&h<Math.min(p,d)&&(l=!0),p<=(l?d:h))f=Math.max(r.top,Math.min(n.top,r.bottom-b))-e.top,u=Math.min(400,l?d:h);else{a=!0,u=Math.min(400,(s?e.right:r.right-e.left)-30);let m=r.bottom-e.bottom;m>=b||m>e.top?f=n.bottom-e.top:(c="bottom",f=e.bottom-n.top)}let x=(e.bottom-e.top)/i.offsetHeight,v=(e.right-e.left)/i.offsetWidth;return{style:`${c}: ${f/x}px; max-width: ${u/v}px`,class:"cm-completionInfo-"+(a?s?"left-narrow":"right-narrow":l?"left":"right")}}function ya(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let o=document.createElement("div");return o.classList.add("cm-completionIcon"),n.type&&o.classList.add(...n.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),o.setAttribute("aria-hidden","true"),o},position:20}),e.push({render(n,o,r,i){let s=document.createElement("span");s.className="cm-completionLabel";let l=n.displayLabel||n.label,a=0;for(let c=0;c<i.length;){let f=i[c++],u=i[c++];f>a&&s.appendChild(document.createTextNode(l.slice(a,f)));let d=s.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(l.slice(f,u))),d.className="cm-completionMatchedText",a=u}return a<l.length&&s.appendChild(document.createTextNode(l.slice(a))),s},position:50},{render(n){if(!n.detail)return null;let o=document.createElement("span");return o.className="cm-completionDetail",o.textContent=n.detail,o},position:80}),e.sort((n,o)=>n.position-o.position).map(n=>n.render)}function Ft(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let r=Math.floor(e/n);return{from:r*n,to:(r+1)*n}}let o=Math.floor((t-e)/n);return{from:t-(o+1)*n,to:t-o*n}}class va{constructor(e,n,o){this.view=e,this.stateField=n,this.applyCompletion=o,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let r=e.state.field(n),{options:i,selected:s}=r.open,l=e.state.facet(B);this.optionContent=ya(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=Ft(i.length,s,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(n).open;for(let f=a.target,u;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(u=/-(\d+)$/.exec(f.id))&&+u[1]<c.length){this.applyCompletion(e,c[+u[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(B).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:ze.of(null)})}),this.showOptions(i,r.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let o=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),o!=r){let{options:i,selected:s,disabled:l}=o.open;(!r.open||r.open.options!=i)&&(this.range=Ft(i.length,s,e.state.facet(B).maxRenderedOptions),this.showOptions(i,o.id)),this.updateSel(),l!=((n=r.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let o of this.currentClass.split(" "))o&&this.dom.classList.remove(o);for(let o of n.split(" "))o&&this.dom.classList.add(o);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=Ft(n.options.length,n.selected,this.view.state.facet(B).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:o}=n.options[n.selected],{info:r}=o;if(!r)return;let i=typeof r=="string"?document.createTextNode(r):r(o);if(!i)return;"then"in i?i.then(s=>{s&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(s,o)}).catch(s=>ct(this.view.state,s,"completion info")):this.addInfoPane(i,o)}}addInfoPane(e,n){this.destroyInfo();let o=this.info=document.createElement("div");if(o.className="cm-tooltip cm-completionInfo",e.nodeType!=null)o.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:i}=e;o.appendChild(r),this.infoDestroy=i||null}this.dom.appendChild(o),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let o=this.list.firstChild,r=this.range.from;o;o=o.nextSibling,r++)o.nodeName!="LI"||!o.id?r--:r==e?o.hasAttribute("aria-selected")||(o.setAttribute("aria-selected","true"),n=o):o.hasAttribute("aria-selected")&&o.removeAttribute("aria-selected");return n&&xa(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),o=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),i=this.space;if(!i){let s=this.dom.ownerDocument.defaultView||window;i={left:0,top:0,right:s.innerWidth,bottom:s.innerHeight}}return r.top>Math.min(i.bottom,n.bottom)-10||r.bottom<Math.max(i.top,n.top)+10?null:this.view.state.facet(B).positionInfo(this.view,n,r,o,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,o){const r=document.createElement("ul");r.id=n,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let i=null;for(let s=o.from;s<o.to;s++){let{completion:l,match:a}=e[s],{section:c}=l;if(c){let d=typeof c=="string"?c:c.name;if(d!=i&&(s>o.from||o.from==0))if(i=d,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let h=r.appendChild(document.createElement("completion-section"));h.textContent=d}}const f=r.appendChild(document.createElement("li"));f.id=n+"-"+s,f.setAttribute("role","option");let u=this.optionClass(l);u&&(f.className=u);for(let d of this.optionContent){let h=d(l,this.view.state,this.view,a);h&&f.appendChild(h)}}return o.from&&r.classList.add("cm-completionListIncompleteTop"),o.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function ba(t,e){return n=>new va(n,t,e)}function xa(t,e){let n=t.getBoundingClientRect(),o=e.getBoundingClientRect(),r=n.height/t.offsetHeight;o.top<n.top?t.scrollTop-=(n.top-o.top)/r:o.bottom>n.bottom&&(t.scrollTop+=(o.bottom-n.bottom)/r)}function bo(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function ka(t,e){let n=[],o=null,r=c=>{n.push(c);let{section:f}=c.completion;if(f){o||(o=[]);let u=typeof f=="string"?f:f.name;o.some(d=>d.name==u)||o.push(typeof f=="string"?{name:u}:f)}},i=e.facet(B);for(let c of t)if(c.hasResult()){let f=c.result.getMatch;if(c.result.filter===!1)for(let u of c.result.options)r(new _o(u,c.source,f?f(u):[],1e9-n.length));else{let u=e.sliceDoc(c.from,c.to),d,h=i.filterStrict?new ga(u):new ma(u);for(let p of c.result.options)if(d=h.match(p.label)){let b=p.displayLabel?f?f(p,d.matched):[]:d.matched;r(new _o(p,c.source,b,d.score+(p.boost||0)))}}}if(o){let c=Object.create(null),f=0,u=(d,h)=>{var p,b;return((p=d.rank)!==null&&p!==void 0?p:1e9)-((b=h.rank)!==null&&b!==void 0?b:1e9)||(d.name<h.name?-1:1)};for(let d of o.sort(u))f-=1e5,c[d.name]=f;for(let d of n){let{section:h}=d.completion;h&&(d.score+=c[typeof h=="string"?h:h.name])}}let s=[],l=null,a=i.compareCompletions;for(let c of n.sort((f,u)=>u.score-f.score||a(f.completion,u.completion))){let f=c.completion;!l||l.label!=f.label||l.detail!=f.detail||l.type!=null&&f.type!=null&&l.type!=f.type||l.apply!=f.apply||l.boost!=f.boost?s.push(c):bo(c.completion)>bo(l)&&(s[s.length-1]=c),l=c.completion}return s}class ke{constructor(e,n,o,r,i,s){this.options=e,this.attrs=n,this.tooltip=o,this.timestamp=r,this.selected=i,this.disabled=s}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new ke(this.options,xo(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,o,r,i){let s=ka(e,n);if(!s.length)return r&&e.some(a=>a.state==1)?new ke(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=n.facet(B).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let a=r.options[r.selected].completion;for(let c=0;c<s.length;c++)if(s[c].completion==a){l=c;break}}return new ke(s,xo(o,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:La,above:i.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new ke(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class bt{constructor(e,n,o){this.active=e,this.id=n,this.open=o}static start(){return new bt(wa,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,o=n.facet(B),i=(o.override||n.languageDataAt("autocomplete",ce(n)).map(pa)).map(l=>(this.active.find(c=>c.source==l)||new U(l,this.active.some(c=>c.state!=0)?1:0)).update(e,o));i.length==this.active.length&&i.every((l,a)=>l==this.active[a])&&(i=this.active);let s=this.open;s&&e.docChanged&&(s=s.map(e.changes)),e.selection||i.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Ca(i,this.active)?s=ke.build(i,n,this.id,s,o):s&&s.disabled&&!i.some(l=>l.state==1)&&(s=null),!s&&i.every(l=>l.state!=1)&&i.some(l=>l.hasResult())&&(i=i.map(l=>l.hasResult()?new U(l.source,0):l));for(let l of e.effects)l.is(mi)&&(s=s&&s.setSelected(l.value,this.id));return i==this.active&&s==this.open?this:new bt(i,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Sa:Aa}}function Ca(t,e){if(t==e)return!0;for(let n=0,o=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;o<e.length&&!e[o].hasResult;)o++;let r=n==t.length,i=o==e.length;if(r||i)return r==i;if(t[n++].result!=e[o++].result)return!1}}const Sa={"aria-autocomplete":"list"},Aa={};function xo(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const wa=[];function di(t,e){if(t.isUserEvent("input.complete")){let o=t.annotation(hi);if(o&&e.activateOnCompletion(o))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class U{constructor(e,n,o=-1){this.source=e,this.state=n,this.explicitPos=o}hasResult(){return!1}update(e,n){let o=di(e,n),r=this;(o&8||o&16&&this.touches(e))&&(r=new U(r.source,0)),o&4&&r.state==0&&(r=new U(this.source,1)),r=r.updateFor(e,o);for(let i of e.effects)if(i.is(vt))r=new U(r.source,1,i.value?ce(e.state):-1);else if(i.is(ze))r=new U(r.source,0);else if(i.is(pi))for(let s of i.value)s.source==r.source&&(r=s);return r}updateFor(e,n){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new U(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(ce(e.state))}}class Se extends U{constructor(e,n,o,r,i){super(e,2,n),this.result=o,this.from=r,this.to=i}hasResult(){return!0}updateFor(e,n){var o;if(!(n&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let i=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),l=ce(e.state);if((this.explicitPos<0?l<=i:l<this.from)||l>s||!r||n&2&&ce(e.startState)==this.from)return new U(this.source,n&4?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return Ma(r.validFor,e.state,i,s)?new Se(this.source,a,r,i,s):r.update&&(r=r.update(r,i,s,new ui(e.state,l,a>=0)))?new Se(this.source,a,r,r.from,(o=r.to)!==null&&o!==void 0?o:ce(e.state)):new U(this.source,1,a)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Se(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new U(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Ma(t,e,n,o){if(!t)return!1;let r=e.sliceDoc(n,o);return typeof t=="function"?t(r,n,o,e):fi(t,!0).test(r)}const pi=O.define({map(t,e){return t.map(n=>n.map(e))}}),mi=O.define(),$=De.define({create(){return bt.start()},update(t,e){return t.update(e)},provide:t=>[Bi.from(t,e=>e.tooltip),k.contentAttributes.from(t,e=>e.attrs)]});function In(t,e){const n=e.completion.apply||e.completion.label;let o=t.state.field($).active.find(r=>r.source==e.source);return o instanceof Se?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},da(t.state,n,o.from,o.to)),{annotations:hi.of(e.completion)})):n(t,e.completion,o.from,o.to),!0):!1}const La=ba($,In);function rt(t,e="option"){return n=>{let o=n.state.field($,!1);if(!o||!o.open||o.open.disabled||Date.now()-o.open.timestamp<n.state.facet(B).interactionDelay)return!1;let r=1,i;e=="page"&&(i=Wo(n,o.open.tooltip))&&(r=Math.max(2,Math.floor(i.dom.offsetHeight/i.dom.querySelector("li").offsetHeight)-1));let{length:s}=o.open.options,l=o.open.selected>-1?o.open.selected+r*(t?1:-1):t?0:s-1;return l<0?l=e=="page"?0:s-1:l>=s&&(l=e=="page"?s-1:0),n.dispatch({effects:mi.of(l)}),!0}}const Da=t=>{let e=t.state.field($,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(B).interactionDelay?!1:In(t,e.open.options[e.open.selected])},Ea=t=>t.state.field($,!1)?(t.dispatch({effects:vt.of(!0)}),!0):!1,Ta=t=>{let e=t.state.field($,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:ze.of(null)}),!0)};class Ba{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const Oa=50,Ra=1e3,Ia=kt.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field($).active)e.state==1&&this.startQuery(e)}update(t){let e=t.state.field($),n=t.state.facet(B);if(!t.selectionSet&&!t.docChanged&&t.startState.field($)==e)return;let o=t.transactions.some(i=>{let s=di(i,n);return s&8||(i.selection||i.docChanged)&&!(s&3)});for(let i=0;i<this.running.length;i++){let s=this.running[i];if(o||s.context.abortOnDocChange&&t.docChanged||s.updates.length+t.transactions.length>Oa&&Date.now()-s.time>Ra){for(let l of s.context.abortListeners)try{l()}catch(a){ct(this.view.state,a)}s.context.abortListeners=null,this.running.splice(i--,1)}else s.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(i=>i.effects.some(s=>s.is(vt)))&&(this.pendingStart=!0);let r=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(s=>s.active.source==i.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let i of t.transactions)i.isUserEvent("input.type")?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field($);for(let n of e.active)n.state==1&&!this.running.some(o=>o.active.source==n.source)&&this.startQuery(n)}startQuery(t){let{state:e}=this.view,n=ce(e),o=new ui(e,n,t.explicitPos==n,this.view),r=new Ba(t,o);this.running.push(r),Promise.resolve(t.source(o)).then(i=>{r.context.aborted||(r.done=i||null,this.scheduleAccept())},i=>{this.view.dispatch({effects:ze.of(null)}),ct(this.view.state,i)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(B).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(B);for(let o=0;o<this.running.length;o++){let r=this.running[o];if(r.done===void 0)continue;if(this.running.splice(o--,1),r.done){let s=new Se(r.active.source,r.active.explicitPos,r.done,r.done.from,(t=r.done.to)!==null&&t!==void 0?t:ce(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)s=s.update(l,n);if(s.hasResult()){e.push(s);continue}}let i=this.view.state.field($).active.find(s=>s.source==r.active.source);if(i&&i.state==1)if(r.done==null){let s=new U(r.active.source,0);for(let l of r.updates)s=s.update(l,n);s.state!=1&&e.push(s)}else this.startQuery(i)}e.length&&this.view.dispatch({effects:pi.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field($,!1);if(e&&e.tooltip&&this.view.state.facet(B).closeOnBlur){let n=e.open&&Wo(this.view,e.open.tooltip);(!n||!n.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ze.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:vt.of(!1)}),20),this.composing=0}}}),Pa=typeof navigator=="object"&&/Win/.test(navigator.platform),$a=cn.highest(k.domEventHandlers({keydown(t,e){let n=e.state.field($,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||t.key.length>1||t.ctrlKey&&!(Pa&&t.altKey)||t.metaKey)return!1;let o=n.open.options[n.open.selected],r=n.active.find(s=>s.source==o.source),i=o.completion.commitCharacters||r.result.commitCharacters;return i&&i.indexOf(t.key)>-1&&In(e,o),!1}})),Na=k.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),qe={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},de=O.define({map(t,e){let n=e.mapPos(t,-1,Oi.TrackAfter);return n??void 0}}),Pn=new class extends Ri{};Pn.startSide=1;Pn.endSide=-1;const gi=De.define({create(){return Ii.empty},update(t,e){if(t=t.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:o=>o>=n.from&&o<=n.to})}for(let n of e.effects)n.is(de)&&(t=t.update({add:[Pn.range(n.value,n.value+1)]}));return t}});function Wa(){return[Ua,gi]}const Ut="()[]{}<>";function _i(t){for(let e=0;e<Ut.length;e+=2)if(Ut.charCodeAt(e)==t)return Ut.charAt(e+1);return un(t<128?t:t+1)}function yi(t,e){return t.languageDataAt("closeBrackets",e)[0]||qe}const Fa=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Ua=k.inputHandler.of((t,e,n,o)=>{if((Fa?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let r=t.state.selection.main;if(o.length>2||o.length==2&&oe(V(o,0))==1||e!=r.from||n!=r.to)return!1;let i=za(t.state,o);return i?(t.dispatch(i),!0):!1}),Ha=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let o=yi(t,t.selection.main.head).brackets||qe.brackets,r=null,i=t.changeByRange(s=>{if(s.empty){let l=qa(t.doc,s.head);for(let a of o)if(a==l&&Tt(t.doc,s.head)==_i(V(a,0)))return{changes:{from:s.head-a.length,to:s.head+a.length},range:_.cursor(s.head-a.length)}}return{range:r=s}});return r||e(t.update(i,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},Va=[{key:"Backspace",run:Ha}];function za(t,e){let n=yi(t,t.selection.main.head),o=n.brackets||qe.brackets;for(let r of o){let i=_i(V(r,0));if(e==r)return i==r?Ga(t,r,o.indexOf(r+r+r)>-1,n):ja(t,r,i,n.before||qe.before);if(e==i&&vi(t,t.selection.main.from))return Ka(t,r,i)}return null}function vi(t,e){let n=!1;return t.field(gi).between(0,t.doc.length,o=>{o==e&&(n=!0)}),n}function Tt(t,e){let n=t.sliceString(e,e+2);return n.slice(0,oe(V(n,0)))}function qa(t,e){let n=t.sliceString(e-2,e);return oe(V(n,0))==n.length?n:n.slice(1)}function ja(t,e,n,o){let r=null,i=t.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:n,from:s.to}],effects:de.of(s.to+e.length),range:_.range(s.anchor+e.length,s.head+e.length)};let l=Tt(t.doc,s.head);return!l||/\s/.test(l)||o.indexOf(l)>-1?{changes:{insert:e+n,from:s.head},effects:de.of(s.head+e.length),range:_.cursor(s.head+e.length)}:{range:r=s}});return r?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function Ka(t,e,n){let o=null,r=t.changeByRange(i=>i.empty&&Tt(t.doc,i.head)==n?{changes:{from:i.head,to:i.head+n.length,insert:n},range:_.cursor(i.head+n.length)}:o={range:i});return o?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Ga(t,e,n,o){let r=o.stringPrefixes||qe.stringPrefixes,i=null,s=t.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:de.of(l.to+e.length),range:_.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=Tt(t.doc,a),f;if(c==e){if(ko(t,a))return{changes:{insert:e+e,from:a},effects:de.of(a+e.length),range:_.cursor(a+e.length)};if(vi(t,a)){let d=n&&t.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+d.length,insert:d},range:_.cursor(a+d.length)}}}else{if(n&&t.sliceDoc(a-2*e.length,a)==e+e&&(f=Co(t,a-2*e.length,r))>-1&&ko(t,f))return{changes:{insert:e+e+e+e,from:a},effects:de.of(a+e.length),range:_.cursor(a+e.length)};if(t.charCategorizer(a)(c)!=P.Word&&Co(t,a,r)>-1&&!Ja(t,a,e,r))return{changes:{insert:e+e,from:a},effects:de.of(a+e.length),range:_.cursor(a+e.length)}}return{range:i=l}});return i?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function ko(t,e){let n=Ee(t).resolveInner(e+1);return n.parent&&n.from==e}function Ja(t,e,n,o){let r=Ee(t).resolveInner(e,-1),i=o.reduce((s,l)=>Math.max(s,l.length),0);for(let s=0;s<5;s++){let l=t.sliceDoc(r.from,Math.min(r.to,r.from+n.length+i)),a=l.indexOf(n);if(!a||a>-1&&o.indexOf(l.slice(0,a))>-1){let f=r.firstChild;for(;f&&f.from==r.from&&f.to-f.from>n.length+a;){if(t.sliceDoc(f.to-n.length,f.to)==n)return!1;f=f.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function Co(t,e,n){let o=t.charCategorizer(e);if(o(t.sliceDoc(e-1,e))!=P.Word)return e;for(let r of n){let i=e-r.length;if(t.sliceDoc(i,e)==r&&o(t.sliceDoc(i-1,i))!=P.Word)return i}return-1}function Qa(t={}){return[$a,$,B.of(t),Ia,Ya,Na]}const bi=[{key:"Ctrl-Space",run:Ea},{key:"Escape",run:Ta},{key:"ArrowDown",run:rt(!0)},{key:"ArrowUp",run:rt(!1)},{key:"PageDown",run:rt(!0,"page")},{key:"PageUp",run:rt(!1,"page")},{key:"Enter",run:Da}],Ya=cn.highest(hn.computeN([B],t=>t.facet(B).defaultKeymap?[bi]:[]));class Za{constructor(e,n,o){this.from=e,this.to=n,this.diagnostic=o}}class he{constructor(e,n,o){this.diagnostics=e,this.panel=n,this.selected=o}static init(e,n,o){let r=e,i=o.facet(Z).markerFilter;i&&(r=i(r,o));let s=E.set(r.map(l=>l.from==l.to||l.from==l.to-1&&o.doc.lineAt(l.from).to==l.from?E.widget({widget:new ac(l),diagnostic:l}).range(l.from):E.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new he(s,n,Me(s))}}function Me(t,e=null,n=0){let o=null;return t.between(n,1e9,(r,i,{spec:s})=>{if(!(e&&s.diagnostic!=e))return o=new Za(r,i,s.diagnostic),!1}),o}function Xa(t,e){let n=e.pos,o=e.end||n,r=t.state.facet(Z).hideOn(t,n,o);if(r!=null)return r;let i=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(s=>s.is($n))||t.changes.touchesRange(i.from,Math.max(i.to,o)))}function xi(t,e){return t.field(H,!1)?e:e.concat(O.appendConfig.of(Ai))}function ec(t,e){return{effects:xi(t,[$n.of(e)])}}const $n=O.define(),Nn=O.define(),ki=O.define(),H=De.define({create(){return new he(E.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),o=null,r=t.panel;if(t.selected){let i=e.changes.mapPos(t.selected.from,1);o=Me(n,t.selected.diagnostic,i)||Me(n,null,i)}!n.size&&r&&e.state.facet(Z).autoPanel&&(r=null),t=new he(n,r,o)}for(let n of e.effects)if(n.is($n)){let o=e.state.facet(Z).autoPanel?n.value.length?je.open:null:t.panel;t=he.init(n.value,o,e.state)}else n.is(Nn)?t=new he(t.diagnostics,n.value?je.open:null,t.selected):n.is(ki)&&(t=new he(t.diagnostics,t.panel,n.value));return t},provide:t=>[fn.from(t,e=>e.panel),k.decorations.from(t,e=>e.diagnostics)]}),tc=E.mark({class:"cm-lintRange cm-lintRange-active"});function nc(t,e,n){let{diagnostics:o}=t.state.field(H),r=[],i=2e8,s=0;o.between(e-(n<0?1:0),e+(n>0?1:0),(a,c,{spec:f})=>{e>=a&&e<=c&&(a==c||(e>a||n>0)&&(e<c||n<0))&&(r.push(f.diagnostic),i=Math.min(a,i),s=Math.max(c,s))});let l=t.state.facet(Z).tooltipFilter;return l&&(r=l(r,t.state)),r.length?{pos:i,end:s,above:t.state.doc.lineAt(i).to<s,create(){return{dom:oc(t,r)}}}:null}function oc(t,e){return S("ul",{class:"cm-tooltip-lint"},e.map(n=>Si(t,n,!1)))}const rc=t=>{let e=t.state.field(H,!1);(!e||!e.panel)&&t.dispatch({effects:xi(t.state,[Nn.of(!0)])});let n=We(t,je.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},So=t=>{let e=t.state.field(H,!1);return!e||!e.panel?!1:(t.dispatch({effects:Nn.of(!1)}),!0)},ic=t=>{let e=t.state.field(H,!1);if(!e)return!1;let n=t.state.selection.main,o=e.diagnostics.iter(n.to+1);return!o.value&&(o=e.diagnostics.iter(0),!o.value||o.from==n.from&&o.to==n.to)?!1:(t.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0}),!0)},sc=[{key:"Mod-Shift-m",run:rc,preventDefault:!0},{key:"F8",run:ic}],lc=kt.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(Z);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(Z);n.length&&Promise.all(n.map(o=>Promise.resolve(o(this.view)))).then(o=>{let r=o.reduce((i,s)=>i.concat(s));this.view.state.doc==e.doc&&this.view.dispatch(ec(this.view.state,r))},o=>{ct(this.view.state,o)})}}update(t){let e=t.state.facet(Z);(t.docChanged||e!=t.startState.facet(Z)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Z=Le.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},Ke(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?o=>e(o)||n(o):e:n}))}});function Bc(t,e={}){return[Z.of({source:t,config:e}),lc,Ai]}function Ci(t){let e=[];if(t)e:for(let{name:n}of t){for(let o=0;o<n.length;o++){let r=n[o];if(/[a-zA-Z]/.test(r)&&!e.some(i=>i.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function Si(t,e,n){var o;let r=n?Ci(e.actions):[];return S("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},S("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(o=e.actions)===null||o===void 0?void 0:o.map((i,s)=>{let l=!1,a=d=>{if(d.preventDefault(),l)return;l=!0;let h=Me(t.state.field(H).diagnostics,e);h&&i.apply(t,h.from,h.to)},{name:c}=i,f=r[s]?c.indexOf(r[s]):-1,u=f<0?c:[c.slice(0,f),S("u",c.slice(f,f+1)),c.slice(f+1)];return S("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${f<0?"":` (access key "${r[s]})"`}.`},u)}),e.source&&S("div",{class:"cm-diagnosticSource"},e.source))}class ac extends $i{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return S("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ao{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Si(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class je{constructor(e){this.view=e,this.items=[];let n=r=>{if(r.keyCode==27)So(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:i}=this.items[this.selectedIndex],s=Ci(i.actions);for(let l=0;l<s.length;l++)if(s[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=Me(this.view.state.field(H).diagnostics,i);a&&i.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},o=r=>{for(let i=0;i<this.items.length;i++)this.items[i].dom.contains(r.target)&&this.moveSelection(i)};this.list=S("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:o}),this.dom=S("div",{class:"cm-panel-lint"},this.list,S("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>So(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(H).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(H),o=0,r=!1,i=null;for(e.between(0,this.view.state.doc.length,(s,l,{spec:a})=>{let c=-1,f;for(let u=o;u<this.items.length;u++)if(this.items[u].diagnostic==a.diagnostic){c=u;break}c<0?(f=new Ao(this.view,a.diagnostic),this.items.splice(o,0,f),r=!0):(f=this.items[c],c>o&&(this.items.splice(o,c-o),r=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),i=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),o++});o<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ao(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:l})=>{let a=l.height/this.list.offsetHeight;s.top<l.top?this.list.scrollTop-=(l.top-s.top)/a:s.bottom>l.bottom&&(this.list.scrollTop+=(s.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function n(){let o=e;e=o.nextSibling,o.remove()}for(let o of this.items)if(o.dom.parentNode==this.list){for(;e!=o.dom;)n();e=o.dom.nextSibling}else this.list.insertBefore(o.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(H),o=Me(n.diagnostics,this.items[e].diagnostic);o&&this.view.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0,effects:ki.of(o)})}static open(e){return new je(e)}}function cc(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function it(t){return cc(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const uc=k.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:it("#d11")},".cm-lintRange-warning":{backgroundImage:it("orange")},".cm-lintRange-info":{backgroundImage:it("#999")},".cm-lintRange-hint":{backgroundImage:it("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Ai=[H,k.decorations.compute([H],t=>{let{selected:e,panel:n}=t.field(H);return!e||!n||e.from==e.to?E.none:E.set([tc.range(e.from,e.to)])}),Pi(nc,{hideOn:Xa}),uc];var wo=function(e){e===void 0&&(e={});var{crosshairCursor:n=!1}=e,o=[];e.closeBracketsKeymap!==!1&&(o=o.concat(Va)),e.defaultKeymap!==!1&&(o=o.concat(Il)),e.searchKeymap!==!1&&(o=o.concat(la)),e.historyKeymap!==!1&&(o=o.concat(Vs)),e.foldKeymap!==!1&&(o=o.concat(Ni)),e.completionKeymap!==!1&&(o=o.concat(bi)),e.lintKeymap!==!1&&(o=o.concat(sc));var r=[];return e.lineNumbers!==!1&&r.push(Wi()),e.highlightActiveLineGutter!==!1&&r.push(Fi()),e.highlightSpecialChars!==!1&&r.push(Ui()),e.history!==!1&&r.push(Rs()),e.foldGutter!==!1&&r.push(Hi()),e.drawSelection!==!1&&r.push(Vi()),e.dropCursor!==!1&&r.push(zi()),e.allowMultipleSelections!==!1&&r.push(Fe.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&r.push(qi()),e.syntaxHighlighting!==!1&&r.push(ln(Qi,{fallback:!0})),e.bracketMatching!==!1&&r.push(ji()),e.closeBrackets!==!1&&r.push(Wa()),e.autocompletion!==!1&&r.push(Qa()),e.rectangularSelection!==!1&&r.push(Ki()),n!==!1&&r.push(Gi()),e.highlightActiveLine!==!1&&r.push(Ji()),e.highlightSelectionMatches!==!1&&r.push(Hl()),e.tabSize&&typeof e.tabSize=="number"&&r.push($o.of(" ".repeat(e.tabSize))),r.concat([hn.of(o.flat())]).filter(Boolean)};const fc="#e5c07b",Mo="#e06c75",hc="#56b6c2",dc="#ffffff",lt="#abb2bf",sn="#7d8799",pc="#61afef",mc="#98c379",Lo="#d19a66",gc="#c678dd",_c="#21252b",Do="#2c313a",Eo="#282c34",Ht="#353a42",yc="#3E4451",To="#528bff",vc=k.theme({"&":{color:lt,backgroundColor:Eo},".cm-content":{caretColor:To},".cm-cursor, .cm-dropCursor":{borderLeftColor:To},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:yc},".cm-panels":{backgroundColor:_c,color:lt},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Eo,color:sn,border:"none"},".cm-activeLineGutter":{backgroundColor:Do},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Ht},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ht,borderBottomColor:Ht},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Do,color:lt}}},{dark:!0}),bc=Oo.define([{tag:g.keyword,color:gc},{tag:[g.name,g.deleted,g.character,g.propertyName,g.macroName],color:Mo},{tag:[g.function(g.variableName),g.labelName],color:pc},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:Lo},{tag:[g.definition(g.name),g.separator],color:lt},{tag:[g.typeName,g.className,g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:fc},{tag:[g.operator,g.operatorKeyword,g.url,g.escape,g.regexp,g.link,g.special(g.string)],color:hc},{tag:[g.meta,g.comment],color:sn},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.link,color:sn,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:Mo},{tag:[g.atom,g.bool,g.special(g.variableName)],color:Lo},{tag:[g.processingInstruction,g.string,g.inserted],color:mc},{tag:g.invalid,color:dc}]),xc=[vc,ln(bc)];var kc=k.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),Cc=function(e){e===void 0&&(e={});var{indentWithTab:n=!0,editable:o=!0,readOnly:r=!1,theme:i="light",placeholder:s="",basicSetup:l=!0}=e,a=[];switch(n&&a.unshift(hn.of([Pl])),l&&(typeof l=="boolean"?a.unshift(wo()):a.unshift(wo(l))),s&&a.unshift(Yi(s)),i){case"light":a.push(kc);break;case"dark":a.push(xc);break;case"none":break;default:a.push(i);break}return o===!1&&a.push(k.editable.of(!1)),r&&a.push(Fe.readOnly.of(!0)),[...a]},Sc=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)}),Bo=xt.define(),Ac=[];function wc(t){var{value:e,selection:n,onChange:o,onStatistics:r,onCreateEditor:i,onUpdate:s,extensions:l=Ac,autoFocus:a,theme:c="light",height:f=null,minHeight:u=null,maxHeight:d=null,width:h=null,minWidth:p=null,maxWidth:b=null,placeholder:x="",editable:v=!0,readOnly:m=!1,indentWithTab:T=!0,basicSetup:A=!0,root:w,initialState:R}=t,[W,ne]=le(),[L,D]=le(),[j,_e]=le(),Bt=k.theme({"&":{height:f,minHeight:u,maxHeight:d,width:h,minWidth:p,maxWidth:b},"& .cm-scroller":{height:"100% !important"}}),Ot=k.updateListener.of(K=>{if(K.docChanged&&typeof o=="function"&&!K.transactions.some(Mi=>Mi.annotation(Bo))){var Ie=K.state.doc,Xe=Ie.toString();o(Xe,K)}r&&r(Sc(K))}),wi=Cc({theme:c,editable:v,readOnly:m,placeholder:x,indentWithTab:T,basicSetup:A}),Re=[Ot,Bt,...wi];return s&&typeof s=="function"&&Re.push(k.updateListener.of(s)),Re=Re.concat(l),Q(()=>{if(W&&!j){var K={doc:e,selection:n,extensions:Re},Ie=R?Fe.fromJSON(R.json,K,R.fields):Fe.create(K);if(_e(Ie),!L){var Xe=new k({state:Ie,parent:W,root:w});D(Xe),i&&i(Xe,Ie)}}return()=>{L&&(_e(void 0),D(void 0))}},[W,j]),Q(()=>ne(t.container),[t.container]),Q(()=>()=>{L&&(L.destroy(),D(void 0))},[L]),Q(()=>{a&&L&&L.focus()},[a,L]),Q(()=>{L&&L.dispatch({effects:O.reconfigure.of(Re)})},[c,l,f,u,d,h,p,b,x,v,m,T,A,o,s]),Q(()=>{if(e!==void 0){var K=L?L.state.doc.toString():"";L&&e!==K&&L.dispatch({changes:{from:0,to:K.length,insert:e||""},annotations:[Bo.of(!0)]})}},[e,L]),{state:j,setState:_e,view:L,setView:D,container:W,setContainer:ne}}var Mc=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Lc=xn((t,e)=>{var{className:n,value:o="",selection:r,extensions:i=[],onChange:s,onStatistics:l,onCreateEditor:a,onUpdate:c,autoFocus:f,theme:u="light",height:d,minHeight:h,maxHeight:p,width:b,minWidth:x,maxWidth:v,basicSetup:m,placeholder:T,indentWithTab:A,editable:w,readOnly:R,root:W,initialState:ne}=t,L=Ss(t,Mc),D=At(null),{state:j,view:_e,container:Bt}=wc({container:D.current,root:W,value:o,autoFocus:f,theme:u,height:d,minHeight:h,maxHeight:p,width:b,minWidth:x,maxWidth:v,basicSetup:m,placeholder:T,indentWithTab:A,editable:w,readOnly:R,selection:r,onChange:s,onStatistics:l,onCreateEditor:a,onUpdate:c,extensions:i,initialState:ne});if(wt(e,()=>({editor:D.current,state:j,view:_e}),[D,Bt,j,_e]),typeof o!="string")throw new Error("value must be typeof string but got "+typeof o);var Ot=typeof u=="string"?"cm-theme-"+u:"cm-theme";return is("div",Zt({ref:D,className:""+Ot+(n?" "+n:"")},L))});Lc.displayName="CodeMirror";export{At as A,He as B,wt as F,ie as H,Lc as R,Je as T,X as _,Te as a,xn as b,Ec as c,Tc as d,le as h,ee as k,Bc as l,gn as q,is as u,Q as y};
